!function(){if(window.phet=window.phet||{},phet.chipper=phet.chipper||{},phet.chipper.packageObject={name:"utterance-queue",version:"0.0.0",license:"MIT",repository:{type:"git",url:"https://github.com/phetsims/utternace-queue.git"},devDependencies:{grunt:"~1.4.0"},phet:{generatedUnitTests:!0,requirejsNamespace:"UTTERANCE_QUEUE",buildStandalone:!0,requiresLodash:!0,assignGlobals:{"phet.utteranceQueue":"UTTERANCE_QUEUE/main","phet.phetCore":"PHET_CORE/main","phet.axon":"AXON/main"}},eslintConfig:{extends:"../chipper/eslint/sim_eslintrc.js"}},!window.hasOwnProperty("_"))throw new Error("Underscore/Lodash not found: _");window.assertions=window.assertions||{},window.assertions.assertFunction=window.assertions.assertFunction||function(e,t){if(!e){if(window.navigator&&"Microsoft Internet Explorer"===window.navigator.appName)try{throw new Error}catch(r){t="".concat(t,", stack=\n").concat(r.stack)}var i=t?"Assertion failed: ".concat(t):"Assertion failed";throw console&&console.log&&console.log(i),window.phet&&phet.chipper&&phet.chipper.queryParameters&&phet.chipper.queryParameters.debugger,new Error(i)}},window.assert=window.assert||null,window.assertSlow=window.assertSlow||null,window.assertions.enableAssert=function(){window.assert=window.assertions.assertFunction,window.console&&window.console.log&&window.console.log("enabling assert")},window.assertions.disableAssert=function(){window.assert=null,window.console&&window.console.log&&window.console.log("disabling assert")},window.assertions.enableAssertSlow=function(){window.assertSlow=window.assertions.assertFunction,window.console&&window.console.log&&window.console.log("enabling assertSlow")},window.assertions.disableAssertSlow=function(){window.assertSlow=null,window.console&&window.console.log&&window.console.log("disabling assertSlow")},function(){window.phetio=window.phetio||{};window.phetio.PhetioIDUtils={append:function(e,...t){return t.forEach(t=>{e+="."+t}),e},getComponentName:function(e){var t=e.lastIndexOf(".");return-1===t?e:e.substring(t+1,e.length)},getParentID:function(e){var t=e.lastIndexOf(".");return-1===t?null:e.substring(0,t)},getDOMElementID:function(e){return"phetioID:".concat(e)},getScreenID:function(e){for(var t=[],i=e.split("."),r=0;r<i.length;r++){var a=i[r];t.push(a);var n=a.indexOf("Screen");if(n>0&&n+"Screen".length===a.length)return t.join(".")}return null},getGroupElementIndex:function(e){return parseInt(e.split(window.phetio.PhetioIDUtils.GROUP_SEPARATOR)[1],10)},isAncestor:function(e,t){for(var i=e.split("."),r=t.split("."),a=0;a<i.length;a++)if(i[a]!==r[a])return!1;return t!==e},SEPARATOR:".",GROUP_SEPARATOR:"_",GENERAL_COMPONENT_NAME:"general",GLOBAL_COMPONENT_NAME:"global",HOME_SCREEN_COMPONENT_NAME:"homeScreen",MODEL_COMPONENT_NAME:"model",VIEW_COMPONENT_NAME:"view",CONTROLLER_COMPONENT_NAME:"controller",COLORS_COMPONENT_NAME:"colors"}}(),(()=>{"use strict";var e={340:(e,t,i)=>{var r;i.d(t,{Z:()=>a}),e=i.hmd(e);try{r=e&&e.hot}catch(n){r=!1}var a=r}},t={};function i(r){var a=t[r];if(void 0!==a)return a.exports;var n=t[r]={id:r,loaded:!1,exports:{}};return e[r](n,n.exports,i),n.loaded=!0,n.exports}i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=i(340);var t=class{constructor(e){this.name=e,window.phet&&(window.phet[e]=this)}register(t,i){if(t.indexOf(".")<0)e.Z,this[t]=i;else{for(var r=t.split("."),a=this,n=0;n<r.length-1;n++)e.Z,a=a[r[n]];var s=r[r.length-1];e.Z,a[s]=i}return i}},r=new t("phetCore");r.register("Namespace",t);var a=r,n=function(e,...t){};a.register("assertMutuallyExclusiveOptions",n);var s=n;function o(e,...t){return _.each(t,t=>{if(t)for(var i in t)if(t.hasOwnProperty(i)){var r=t[i];_.endsWith(i,"Options")&&"Options"!==i?e[i]=o(e[i]||{},r):e[i]=r}}),e}a.register("merge",o);var l=o,h=new t("axon");_.hasIn(window,"phet.chipper.queryParameters")&&phet.chipper.queryParameters.shuffleListeners;class p{constructor(e){e&&(this.onBeforeNotify=e),this.listeners=new Set,this.emitContexts=[]}dispose(){this.removeAllListeners()}emit(...e){if(this.onBeforeNotify&&this.onBeforeNotify.apply(null,e),this.listeners.size>0){var t={index:0};for(var i of(this.emitContexts.push(t),this.listeners))if(i(...e),t.index++,t.listenerArray)break;if(t.listenerArray)for(var r=t.index;r<t.listenerArray.length;r++)t.listenerArray[r](...e);this.emitContexts.pop()}}addListener(e){this.guardListeners(),this.listeners.add(e),this.changeCount&&this.changeCount(1)}removeListener(e){this.guardListeners(),this.listeners.delete(e),this.changeCount&&this.changeCount(-1)}removeAllListeners(){var e=this.listeners.size;this.guardListeners(),this.listeners.clear(),this.changeCount&&this.changeCount(-e)}guardListeners(){for(var e=this.emitContexts.length-1;e>=0&&!this.emitContexts[e].listenerArray;e--)this.emitContexts[e].listenerArray=Array.from(this.listeners)}hasListener(e){return this.listeners.has(e)}hasListeners(){return this.listeners.size>0}getListenerCount(){return this.listeners.size}forEachListener(e){this.listeners.forEach(e)}}h.register("TinyEmitter",p);var u=p;class d extends u{setTimeout(e,t){var i=0,r=a=>{1e3*(i+=a)>=t&&this.hasListener(r)&&(e(),this.removeListener(r))};return this.addListener(r),r}clearTimeout(e){this.hasListener(e)&&this.removeListener(e)}setInterval(e,t){var i=0,r=a=>{for(i+=a;1e3*i>=t&&-1!==this.hasListener(r);)e(),i-=t/1e3};return this.addListener(r),r}clearInterval(e){this.hasListener(e)&&this.removeListener(e)}runOnNextTick(e){this.setTimeout(e,0)}}h.register("Timer",d);var c=d,m=new c;h.register("animationFrameTimer",m);class y{constructor(e){e.keys,e.map;var t=e.keys||Object.keys(e.map),i=e.map||{};e=l({phetioDocumentation:null,beforeFreeze:null},e),this.phetioDocumentation=e.phetioDocumentation,this.KEYS=t,this.VALUES=[],t.forEach(e=>{var t=i[e]||{};t.name=e,t.toString=()=>e,this[e]=t,this.VALUES.push(t)}),e.beforeFreeze&&e.beforeFreeze(this)}includes(e){return _.includes(this.VALUES,e)}static byKeys(e,t){return new y(l({keys:e},t))}static byMap(e,t){return new y(l({map:e},t))}}a.register("Enumeration",y);var g=y,v=["string","number","boolean","function"],f={assertions:!1},T=["valueType","validValues","isValidValue","arrayElementType","phetioType"],E={isValidValidator(e,t){if(t=t||f,!(e instanceof Object))return!1;if(!(e.hasOwnProperty("isValidValue")||e.hasOwnProperty("valueType")||e.hasOwnProperty("arrayElementType")||e.hasOwnProperty("validValues")||e.hasOwnProperty("phetioType")))return!1;if(e.hasOwnProperty("valueType")&&!P(e.valueType,t))return!1;if(e.hasOwnProperty("arrayElementType")){if(e.hasOwnProperty("valueType"))return!1;if(!P(e.arrayElementType,t))return!1}if(e.hasOwnProperty("isValidValue")&&"function"!=typeof e.isValidValue&&null!==e.isValidValue&&void 0!==e.isValidValue)return!1;if(void 0!==e.validValues&&null!==e.validValues){if(!Array.isArray(e.validValues))return!1;var i=_.omit(e,"validValues");if(E.containsValidatorKey(i))for(var r=0;r<e.validValues.length;r++)if(!E.isValueValid(e.validValues[r],i))return!1}return!e.hasOwnProperty("phetioType")||!(!e.phetioType||!e.phetioType.validator)&&E.isValidValidator(e.phetioType.validator,t)},validateValueType:(e,t)=>("function"==typeof e||"string"==typeof e||e instanceof g||null==e)&&!("string"==typeof e&&!_.includes(v,e)),validateValidator(e){0},containsValidatorKey(e){for(var t=0;t<T.length;t++)if(e.hasOwnProperty(T[t]))return!0;return!1},formulateAssertionMessage:(e,t)=>(t&&(e="".concat(t,": ").concat(e)),e),isValueValid(e,t,i){if((i=l({validateValidator:!0,assertions:!1,message:null},i)).validateValidator&&!h.ValidatorDef.isValidValidator(t,i))return!1;if(t.hasOwnProperty("valueType")){var r=t.valueType;if(Array.isArray(r)){if(!_.some(r.map(t=>E.isValueValidValueType(e,t,i.message,f))))return!1}else if(r&&!E.isValueValidValueType(e,r,i.message,i))return!1}if(t.hasOwnProperty("arrayElementType")){var a=t.arrayElementType;if(!E.isValueValid(e,{valueType:Array},i))return!1;if(!_.every(e.map(e=>Array.isArray(a)?!!_.some(a.map(t=>E.isValueValidValueType(e,t,i.message,f))):E.isValueValidValueType(e,t.arrayElementType,i.message,i))))return!1}return(!t.hasOwnProperty("validValues")||-1!==t.validValues.indexOf(e))&&(!(t.hasOwnProperty("isValidValue")&&!t.isValidValue(e))&&!(t.hasOwnProperty("phetioType")&&!E.isValueValid(e,t.phetioType.validator,f)))},isValueValidValueType:(e,t,i,r)=>("string"!=typeof t||typeof e===t)&&(!(t===Array&&!Array.isArray(e))&&(!(t instanceof g&&!t.includes(e))&&(("function"!=typeof t||e instanceof t)&&(null!==t||null===e))))},P=(e,t)=>{if(Array.isArray(e)){if(!_.every(e.map(e=>E.validateValueType(e,t))))return!1}else if(e&&!E.validateValueType(e,t))return!1;return!0};E.VALIDATOR_KEYS=T,E.STRING_WITHOUT_TEMPLATE_VARS_VALIDATOR={valueType:"string",isValidValue:e=>!/\{\{\w*\}\}/.test(e)},h.register("ValidatorDef",E);var b=E,O=(e,t,i,r)=>{0};h.register("validate",O);var A=O;function I(e,t){var i=_.indexOf(e,t);e.splice(i,1)}a.register("arrayRemove",I);var w=I;function S(e){return e}a.register("required",S);var D=S,N=new t("tandem"),L={IO_TYPE_SUFFIX:"IO"};N.register("PhetioConstants",L);var M=L,x={OBJECT_IO_TYPE_NAME:"ObjectIO",EVENT_TYPE_MODEL:"MODEL",PHET_IO_OBJECT_METADATA_DEFAULTS:{phetioTypeName:"ObjectIO",phetioDocumentation:"",phetioState:!0,phetioReadOnly:!1,phetioEventType:"MODEL",phetioHighFrequency:!1,phetioPlayback:!1,phetioStudioControl:!0,phetioDynamicElement:!1,phetioIsArchetype:!1,phetioFeatured:!1,phetioDesigned:!1,phetioArchetypePhetioID:null}};N.register("TandemConstants",x);var V=x;class C{constructor(e){e=l({displayString:"",validator:null,compositeSchema:null},e),this.displayString=e.displayString,this.validator=e.validator,this.compositeSchema=e.compositeSchema}validateStateSchema(e){}isComposite(){return!!this.compositeSchema}checkStateObjectValid(e,t,i,r){if(this.isComposite()){var a=this.compositeSchema,n=null,s=(e,t,i,r)=>{Object.keys(e).filter(e=>e!==r).forEach(r=>{var a=t.hasOwnProperty(r);a||(n=!1),e[r].validateStateObject(t[r]),i.push(r)})};return s(a,e,i,"_private"),a._private&&s(a._private,e._private,r,null),n}return t&&A(e,this.validator),b.isValueValid(e,this.validator)}getRelatedTypes(){var e=[],t=t=>{Object.keys(t).forEach(i=>{t[i]instanceof B&&e.push(t[i])})};return this.compositeSchema&&(t(this.compositeSchema),this.compositeSchema._private&&t(this.compositeSchema._private)),e}getStateSchemaAPI(){if(this.isComposite()){var e=_.mapValues(this.compositeSchema,e=>e.typeName);return this.compositeSchema._private&&(e._private=_.mapValues(this.compositeSchema._private,e=>e.typeName)),e}return this.displayString}static asValue(e,t){return new C({validator:t,displayString:e})}}N.register("StateSchema",C);var R=C,k={validateValidator:!1},F=null,j=e=>{var t=e.indexOf(M.IO_TYPE_SUFFIX);return e.substring(0,t)};class U{constructor(e,t){var i=t.supertype||F;t.toStateObject,t.applyState,t.stateSchema;t=l({supertype:F,methods:{},events:[],metadataDefaults:{},dataDefaults:{},methodOrder:[],parameterTypes:[],documentation:"IO Type for ".concat(j(e)),isFunctionType:!1,toStateObject:i&&i.toStateObject,fromStateObject:i&&i.fromStateObject,stateToArgsForConstructor:i&&i.stateToArgsForConstructor,applyState:i&&i.applyState,stateSchema:null,addChildElement:i&&i.addChildElement},D(t)),this.supertype=i,this.typeName=e,this.documentation=t.documentation,this.methods=t.methods,this.events=t.events,this.metadataDefaults=t.metadataDefaults,this.dataDefaults=t.dataDefaults,this.methodOrder=t.methodOrder,this.parameterTypes=t.parameterTypes,this.validator=_.pick(t,b.VALIDATOR_KEYS),this.toStateObject=e=>{A(e,this.validator,"unexpected parameter to toStateObject",k);var i=t.toStateObject(e);return i},this.fromStateObject=t.fromStateObject,this.stateToArgsForConstructor=t.stateToArgsForConstructor,this.applyState=(e,i)=>{A(e,this.validator,"unexpected parameter to applyState",k),t.applyState(e,i)};var r=t.stateSchema;if(null!==r&&!(r instanceof R)){var a="function"==typeof r?r(this):r;r=new R({compositeSchema:a})}this.stateSchema=r,this.isFunctionType=t.isFunctionType,this.addChildElement=t.addChildElement;this.typeName.split(/[<(]/)[0];if(Object.values(this.methods).forEach(e=>{}),this.hasOwnProperty("methodOrder")&&this.methodOrder.forEach(e=>{}),i)i.getTypeHierarchy()}getTypeHierarchy(){for(var e=[],t=this;t;)e.push(t),t=t.supertype;return e}getAllMetadataDefaults(){return _.merge({},this.supertype?this.supertype.getAllMetadataDefaults():{},this.metadataDefaults)}getAllDataDefaults(){return _.merge({},this.supertype?this.supertype.getAllDataDefaults():{},this.dataDefaults)}isStateObjectValid(e,t=!1,i=[],r=[]){var a=!0;if(this.stateSchema){var n=this.stateSchema.checkStateObjectValid(e,t,i,r);if(null!==n)return n}if(this.supertype&&(!this.stateSchema||!this.stateSchema.isComposite()))return a&&this.supertype.isStateObjectValid(e,t,i,r);if(!this.supertype&&e&&"string"!=typeof e&&!Array.isArray(e)){var s=(e,t)=>{var n=("public"===e?i:r).includes(t);n||(a=!1)};return Object.keys(e).filter(e=>"_private"!==e).forEach(e=>s("public",e)),e._private&&Object.keys(e._private).forEach(e=>s("private",e)),a}return!0}validateStateObject(e){this.isStateObjectValid(e,!0)}static fromCoreType(e,t,i){for(var r=!1,a=t.prototype;a;)"function"==typeof a.toStateObject&&!0,"function"==typeof a.applyState&&(r=!0),a=Object.getPrototypeOf(a);return i=l({valueType:t,toStateObject:e=>e.toStateObject()},i),r&&(i.applyState=(e,t)=>e.applyState(t)),t.fromStateObject&&(i.fromStateObject=t.fromStateObject),t.STATE_SCHEMA&&(i.stateSchema=_.clone(t.STATE_SCHEMA)),t.stateToArgsForConstructor&&(i.stateToArgsForConstructor=t.stateToArgsForConstructor),new U(e,i)}}F=new U(V.OBJECT_IO_TYPE_NAME,{isValidValue:()=>!0,supertype:null,documentation:"The root of the IO Type hierarchy",toStateObject:e=>null,fromStateObject:e=>null,stateToArgsForConstructor:e=>[],applyState:(e,t)=>{},metadataDefaults:V.PHET_IO_OBJECT_METADATA_DEFAULTS,dataDefaults:{initialState:null},stateSchema:null}),U.ObjectIO=F,N.register("IOType",U);var B=U,z=new Map,H=e=>{if(!z.has(e)){var t=e=>e.name,i=e.VALUES.map(t),r=e.phetioDocumentation?" ".concat(e.phetioDocumentation):"";z.set(e,new B("EnumerationIO(".concat(i.join("|"),")"),{valueType:e,documentation:"Possible values: ".concat(i,".").concat(r),toStateObject:e=>t(e),fromStateObject:t=>e[t],stateSchema:R.asValue("".concat(i.join("|")),{isValidValue:e=>i.includes(e)})}))}return z.get(e)};a.register("EnumerationIO",H);var q=H,G=g.byKeys(["USER",V.EVENT_TYPE_MODEL,"WRAPPER","OPT_OUT"],{beforeFreeze:e=>{e.phetioType=q(e)}});N.register("EventType",G);var Y=G,W=_.hasIn(window,"phet.chipper.packageObject")?phet.chipper.packageObject:{name:"placeholder"},X=_.hasIn(window,"phet.preloads.phetio"),K=X&&phet.preloads.phetio.queryParameters.phetioPrintMissingTandems,J=!_.hasIn(W,"phet.phet-io.validation")||W.phet["phet-io"].validation,Q=window.QueryStringMachine&&QueryStringMachine.containsKey("phetioValidation"),Z=X&&Q?phet.preloads.phetio.queryParameters.phetioValidation:X&&J,$=X&&Z&&!K,ee={required:[],optional:[]},te=[],ie=[];class re{constructor(e,t,i){this.parentTandem=e,this.name=t,this.phetioID=this.parentTandem?window.phetio.PhetioIDUtils.append(this.parentTandem.phetioID,this.name):this.name,i=l({required:!0,supplied:!0},i),this.children={},this.parentTandem&&this.parentTandem.addChild(t,this),this.required=i.required,this.supplied=i.supplied,this.isDisposed=!1}getTermRegex(){return/^[a-zA-Z0-9[\],]+$/}static onMissingTandem(e){if(K&&!e.supplied){var t=(new Error).stack;e.required?ee.required.push({phetioID:this.phetioID,stack:t}):-1===t.indexOf("Font")&&ee.optional.push({phetioID:this.phetioID,stack:t})}}addPhetioObject(e){if(X){if(!this.required&&!this.supplied)return;if(re.launched)for(var t=0;t<te.length;t++)te[t].addPhetioObject(e);else ie.push(e)}}hasAncestor(e){return this.parentTandem===e||this.parentTandem&&this.parentTandem.hasAncestor(e)}removePhetioObject(e){if(this.required||this.supplied){if(X)if(re.launched)for(var t=0;t<te.length;t++)te[t].removePhetioObject(e);else w(ie,e);e.tandem.dispose()}}getExtendedOptions(e){return l({supplied:this.supplied,required:this.required},e)}createTandem(e,t){if(t=this.getExtendedOptions(t),this.hasChild(e)){var i=this.children[e];return i}return new re(this,e,t)}hasChild(e){return this.children.hasOwnProperty(e)}addChild(e,t){this.children[e]=t}iterateDescendants(e){for(var t in this.children)this.children.hasOwnProperty(t)&&(e(this.children[t]),this.children[t].iterateDescendants(e))}removeChild(e){delete this.children[e]}dispose(){this.parentTandem.removeChild(this.name),this.isDisposed=!0}getArchetypalPhetioID(){return this.parentTandem?window.phetio.PhetioIDUtils.append(this.parentTandem.getArchetypalPhetioID(),this.name):this.phetioID}createGroupTandem(e){return this.children[e]?this.children[e]:new se(this,e)}equals(e){return this.phetioID===e.phetioID}static addPhetioObjectListener(e){te.push(e)}static launch(){for(re.launched=!0;ie.length>0;){var e=ie.shift();e.tandem.addPhetioObject(e)}}static unlaunch(){re.launched=!1,ie.length=0}}re.bufferedPhetioObjects=ie;re.ROOT=new class extends re{createTandem(e,t){if(re.VALIDATION)e===window.phetio.PhetioIDUtils.GLOBAL_COMPONENT_NAME||"requiredTandem"===e||"optionalTandem"===e||"test"===e||e===window.phetio.PhetioIDUtils.GENERAL_COMPONENT_NAME||_.endsWith(e,"Screen");return super.createTandem(e,t)}}(null,_.camelCase(W.name));var ae=re.ROOT.createTandem(window.phetio.PhetioIDUtils.GENERAL_COMPONENT_NAME);re.ROOT_TEST=re.ROOT.createTandem("test"),re.GENERAL_MODEL=ae.createTandem(window.phetio.PhetioIDUtils.MODEL_COMPONENT_NAME),re.GENERAL_VIEW=ae.createTandem(window.phetio.PhetioIDUtils.VIEW_COMPONENT_NAME),re.GENERAL_CONTROLLER=ae.createTandem(window.phetio.PhetioIDUtils.CONTROLLER_COMPONENT_NAME);var ne=re.ROOT.createTandem(window.phetio.PhetioIDUtils.GLOBAL_COMPONENT_NAME);re.GLOBAL_MODEL=ne.createTandem(window.phetio.PhetioIDUtils.MODEL_COMPONENT_NAME),re.GLOBAL_VIEW=ne.createTandem(window.phetio.PhetioIDUtils.VIEW_COMPONENT_NAME),re.COLORS=re.GLOBAL_VIEW.createTandem(window.phetio.PhetioIDUtils.COLORS_COMPONENT_NAME),re.OPTIONAL=re.ROOT.createTandem("optionalTandem",{required:!1,supplied:!1}),re.OPT_OUT=re.OPTIONAL,re.REQUIRED=re.ROOT.createTandem("requiredTandem",{required:$||K,supplied:!1}),re.missingTandems=ee,re.PHET_IO_ENABLED=X,re.API_GENERATION=re.PHET_IO_ENABLED&&(phet.preloads.phetio.queryParameters.phetioPrintAPI||phet.preloads.phetio.queryParameters.phetioCompareAPI),re.VALIDATION=$,re.METADATA_KEY="_metadata",re.DATA_KEY="_data";class se extends re{constructor(e,t){super(e,t),this.groupName=t,this.groupMemberIndex=0}createNextTandem(){var e=this.parentTandem.createTandem("".concat(this.groupName).concat(this.groupMemberIndex));return this.groupMemberIndex++,e}}re.launched=!1,N.register("Tandem",re);var oe=re,le=new B("ValueIO",{isValidValue:_.stubTrue,supertype:B.ObjectIO,toStateObject:e=>e,fromStateObject:e=>e,stateSchema:R.asValue("*",{isValidValue:_.stubTrue})});N.register("ValueIO",le);var he=le,pe=new B("StringIO",{supertype:he,valueType:"string",documentation:"IO Type for Javascript's string primitive type",stateSchema:R.asValue("string",{valueType:"string"})});N.register("StringIO",pe);var ue=pe,de=new B("LinkedElementIO",{isValidValue:()=>!0,documentation:"A LinkedElement",toStateObject:e=>({elementID:e.element.tandem.phetioID}),fromStateObject:e=>({}),stateSchema:{elementID:ue}});N.register("LinkedElementIO",de);var ce=de;class me extends oe{constructor(e,t,i){super(e,t,i)}getTermRegex(){return/^[a-zA-Z0-9_]+$/}getArchetypalPhetioID(){return window.phetio.PhetioIDUtils.append(this.parentTandem.getArchetypalPhetioID(),"archetype")}}me.DYNAMIC_ARCHETYPE_NAME="archetype",N.register("DynamicTandem",me);var ye=me,ge=["phetioDynamicElement","phetioEventType","phetioIsArchetype","phetioPlayback","phetioReadOnly","phetioState","phetioTypeName"];var ve=(e,t,i,r)=>{var a=t.getMetadata();ge.forEach(n=>{"phetioDynamicElement"!==n&&"phetioArchetypePhetioID"!==n&&"phetioIsArchetype"!==n&&i[n]!==a[n]&&e.assertAPIError({phetioID:t.tandem.phetioID,ruleInViolation:"5. Dynamic element metadata should match the archetype in the API.",source:r,message:"mismatched metadata: ".concat(n)})})},fe=new class{constructor(){this.apiMismatches=[],this.simHasStarted=!1,this.enabled=!1,this.everyPhetioType={}}onSimStarted(e){this.simHasStarted=!0,this.enabled&&phet.joist.sim.allScreensCreated&&this.validateOverridesFile()}onPhetioObjectRemoved(e){if(this.enabled){var t=e.tandem.phetioID;e.phetioDynamicElement||this.assertAPIError({phetioID:t,ruleInViolation:"2. Any static, registered PhetioObject can never be deregistered."})}}onPhetioObjectAdded(e){if(this.enabled){var t=e.phetioType;this.everyPhetioType[t.typeName]||(this.everyPhetioType[t.typeName]=t),this.simHasStarted&&phet.axon.animationFrameTimer.runOnNextTick(()=>{if(e.phetioDynamicElement){if(phet.preloads.phetio.createArchetypes){var t=e.tandem.getArchetypalPhetioID(),i=phet.phetio.phetioEngine.getPhetioObject(t).getMetadata();ve(this,e,i,"simulation archetype")}}else this.assertAPIError({phetioID:e.tandem.phetioID,ruleInViolation:"1. After startup, only dynamic instances prescribed by the baseline file can be registered."})})}}validateOverridesFile(){var e=phet.phetio.phetioEngine.getPhetioElementsBaseline();for(var t in window.phet.preloads.phetio.phetioElementsOverrides){t.indexOf(ye.DYNAMIC_ARCHETYPE_NAME);if(phet.preloads.phetio.createArchetypes||e.hasOwnProperty(t))if(e.hasOwnProperty(t)){var i=window.phet.preloads.phetio.phetioElementsOverrides[t],r=e[t];for(var a in 0===Object.keys(i).length&&this.assertAPIError({phetioID:t,ruleInViolation:"4. Any schema entries in the overrides file must be different from its baseline counterpart.",message:"no metadata keys found for this override."}),i)r.hasOwnProperty(a)||this.assertAPIError({phetioID:t,ruleInViolation:"8. Any schema entries in the overrides file must be different from its baseline counterpart.",message:"phetioID metadata key not found in the baseline: ".concat(a)}),i[a]===r[a]&&this.assertAPIError({phetioID:t,ruleInViolation:"8. Any schema entries in the overrides file must be different from its baseline counterpart.",message:"phetioID metadata override value is the same as the corresponding metadata value in the baseline."})}else this.assertAPIError({phetioID:t,ruleInViolation:"3. Any schema entries in the overrides file must exist in the baseline file.",message:"phetioID expected in the baseline file but does not exist"});else;}}assertAPIError(e){e.phetioID?"".concat(e.phetioID,":  ").concat(e.ruleInViolation):"".concat(e.ruleInViolation);console.log("error data:",e)}};N.register("phetioAPIValidation",fe);var Te=fe,Ee=oe.PHET_IO_ENABLED,Pe=e=>e.tandem.phetioID,be={tandem:oe.OPTIONAL,phetioType:B.ObjectIO,phetioDocumentation:V.PHET_IO_OBJECT_METADATA_DEFAULTS.phetioDocumentation,phetioState:V.PHET_IO_OBJECT_METADATA_DEFAULTS.phetioState,phetioReadOnly:V.PHET_IO_OBJECT_METADATA_DEFAULTS.phetioReadOnly,phetioEventType:Y.MODEL,phetioHighFrequency:V.PHET_IO_OBJECT_METADATA_DEFAULTS.phetioHighFrequency,phetioPlayback:V.PHET_IO_OBJECT_METADATA_DEFAULTS.phetioPlayback,phetioStudioControl:V.PHET_IO_OBJECT_METADATA_DEFAULTS.phetioStudioControl,phetioFeatured:V.PHET_IO_OBJECT_METADATA_DEFAULTS.phetioFeatured,phetioDynamicElement:V.PHET_IO_OBJECT_METADATA_DEFAULTS.phetioDynamicElement,phetioDesigned:V.PHET_IO_OBJECT_METADATA_DEFAULTS.phetioDesigned,phetioEventMetadata:null};class Oe{constructor(e){this.tandem=be.tandem,this.phetioObjectInitialized=!1,this.isDisposed=!1,e&&this.initializePhetioObject({},e)}initializePhetioObject(e,t){if(t.tandem&&oe.onMissingTandem(t.tandem),oe.VALIDATION&&t.tandem&&t.tandem.required,Ee&&t.tandem&&t.tandem.supplied){t=l({},be,e,t),this.phetioIsArchetype=!1,this.phetioBaselineMetadata=Te.enabled||phet.preloads.phetio.queryParameters.phetioEmitAPIBaseline?this.getMetadata(l({phetioIsArchetype:this.phetioIsArchetype},t)):null;var i=t.tandem.getArchetypalPhetioID();if(window.phet.preloads.phetio.phetioElementsOverrides){var r=window.phet.preloads.phetio.phetioElementsOverrides[i];r&&(t=l(t,r))}this.tandem=t.tandem,this._phetioType=t.phetioType,this._phetioState=t.phetioState,this._phetioReadOnly=t.phetioReadOnly,this._phetioDocumentation=t.phetioDocumentation,this._phetioEventType=t.phetioEventType,this._phetioHighFrequency=t.phetioHighFrequency,this._phetioPlayback=t.phetioPlayback,this._phetioStudioControl=t.phetioStudioControl,this._phetioDynamicElement=t.phetioDynamicElement,this._phetioFeatured=t.phetioFeatured,this._phetioEventMetadata=t.phetioEventMetadata,this._phetioDesigned=t.phetioDesigned,this.phetioArchetypePhetioID=null,this.linkedElements=[],this.phetioNotifiedObjectCreated=!1,this.phetioMessageStack=[],this._phetioPlayback&&(this._phetioEventMetadata=this._phetioEventMetadata||{},this._phetioEventMetadata.playback=!0),this.tandem.addPhetioObject(this),this.phetioObjectInitialized=!0}else t.tandem&&(this.tandem=t.tandem)}get phetioType(){return this._phetioType}get phetioState(){return this._phetioState}get phetioReadOnly(){return this._phetioReadOnly}get phetioDocumentation(){return this._phetioDocumentation}get phetioEventType(){return this._phetioEventType}get phetioHighFrequency(){return this._phetioHighFrequency}get phetioPlayback(){return this._phetioPlayback}get phetioStudioControl(){return this._phetioStudioControl}get phetioDynamicElement(){return this._phetioDynamicElement}get phetioFeatured(){return this._phetioFeatured}get phetioEventMetadata(){return this._phetioEventMetadata}get phetioDesigned(){return this._phetioDesigned}phetioStartEvent(e,t){if(Ee&&this.isPhetioInstrumented()){if(t=l({data:null,getData:null},t),this.phetioHighFrequency&&_.hasIn(window,"phet.preloads.phetio.queryParameters")&&!window.phet.preloads.phetio.queryParameters.phetioEmitHighFrequencyEvents&&!phet.phetio.dataStream.isEmittingLowFrequencyEvent()||this.phetioEventType===Y.OPT_OUT)return void this.phetioMessageStack.push(-1);var i=t.getData?t.getData():t.data;this.phetioMessageStack.push(phet.phetio.dataStream.start(this.phetioEventType,this.tandem.phetioID,this.phetioType,e,i,this.phetioEventMetadata,this.phetioHighFrequency)),this.phetioPlayback&&phet.phetio.dataStream.pushNonPlaybackable()}}phetioEndEvent(){if(Ee&&this.isPhetioInstrumented()){var e=this.phetioMessageStack.pop();if(-1===e)return;this.phetioPlayback&&phet.phetio.dataStream.popNonPlaybackable(),phet.phetio.dataStream.end(e)}}propagateDynamicFlagsToDescendants(){var e=phet.phetio.phetioEngine,t=oe.launched?[]:oe.bufferedPhetioObjects.map(Pe);this.tandem.iterateDescendants(i=>{var r=i.phetioID;if(e.hasPhetioObject(r)||!oe.launched&&t.includes(r)){var a=e.hasPhetioObject(r)?e.getPhetioObject(r):oe.bufferedPhetioObjects[t.indexOf(r)];a.phetioIsArchetype=this.phetioIsArchetype,a.setPhetioDynamicElement(this.phetioDynamicElement),a.phetioBaselineMetadata&&(a.phetioBaselineMetadata.phetioIsArchetype=this.phetioIsArchetype)}})}setPhetioDynamicElement(e){this._phetioDynamicElement=!this.phetioIsArchetype&&e,this.phetioArchetypePhetioID=e?this.tandem.getArchetypalPhetioID():null,this.phetioBaselineMetadata&&(this.phetioBaselineMetadata.phetioDynamicElement=this.phetioDynamicElement)}markDynamicElementArchetype(){this.phetioIsArchetype=!0,this.setPhetioDynamicElement(!1),this.phetioBaselineMetadata&&(this.phetioBaselineMetadata.phetioIsArchetype=this.phetioIsArchetype),oe.PHET_IO_ENABLED&&this.propagateDynamicFlagsToDescendants()}isPhetioInstrumented(){return this.tandem&&this.tandem.supplied}addLinkedElement(e,t){this.isPhetioInstrumented()?Ee&&e.isPhetioInstrumented()&&this.linkedElements.push(new Ae(e,t)):this.linkedElements=null}removeLinkedElements(e){this.isPhetioInstrumented()&&this.linkedElements&&this.linkedElements.filter(t=>t.element===e).forEach(e=>{e.dispose(),w(this.linkedElements,e)})}onSimulationConstructionCompleted(){this.phetioBaselineMetadata=null}dispose(){var e=[];if(oe.PHET_IO_ENABLED&&this.tandem.supplied){var t=phet.phetio.phetioEngine;this.tandem.iterateDescendants(i=>{t.hasPhetioObject(i.phetioID)&&e.push(t.getPhetioObject(i.phetioID))})}this.phetioObjectInitialized&&this.tandem.removePhetioObject(this),this.linkedElements&&(this.linkedElements.forEach(e=>e.dispose()),this.linkedElements.length=0),this.isDisposed=!0}getMetadata(e){var t={phetioTypeName:(e=e||this).phetioType.typeName,phetioDocumentation:e.phetioDocumentation,phetioState:e.phetioState,phetioReadOnly:e.phetioReadOnly,phetioEventType:Y.phetioType.toStateObject(e.phetioEventType),phetioHighFrequency:e.phetioHighFrequency,phetioPlayback:e.phetioPlayback,phetioStudioControl:e.phetioStudioControl,phetioDynamicElement:e.phetioDynamicElement,phetioIsArchetype:e.phetioIsArchetype,phetioFeatured:e.phetioFeatured,phetioDesigned:e.phetioDesigned};return e.phetioArchetypePhetioID&&(t.phetioArchetypePhetioID=e.phetioArchetypePhetioID),t}}Oe.DEFAULT_OPTIONS=be;class Ae extends Oe{constructor(e,t){(t=l({phetioType:ce},t)).phetioReadOnly=!0,t.phetioFeatured=e.phetioFeatured,super(t),this.element=e}getMetadata(e){var t=super.getMetadata(e);return delete t.phetioFeatured,t}}N.register("PhetioObject",Oe);var Ie=Oe,we=new B("VoidIO",{isValidValue:()=>!0,documentation:"Type for which there is no instance, usually to mark functions without a return value",toStateObject:e=>{}});N.register("VoidIO",we);var Se=we,De=[],_e=(["name","phetioType","phetioDocumentation","phetioPrivate"].concat(b.VALIDATOR_KEYS),e=>e.phetioType),Ne=e=>e.name;class Le extends Ie{constructor(e,t){var i=(t=l({parameters:De,tandem:oe.OPTIONAL,phetioOuterType:Le.ActionIO,phetioState:!1,phetioPlayback:Ie.DEFAULT_OPTIONS.phetioPlayback,phetioEventMetadata:Ie.DEFAULT_OPTIONS.phetioEventMetadata,phetioDocumentation:"A function that executes."},t)).parameters.filter(_e);t.phetioType=t.phetioOuterType(i.map(_e)),t.phetioPlayback&&(t.phetioEventMetadata=t.phetioEventMetadata||{},t.phetioEventMetadata.dataKeys=t.parameters.map(Ne)),t.phetioDocumentation=Le.getPhetioDocumentation(t.phetioDocumentation,i),super(t),this._parameters=t.parameters,this._action=e,this._phetioOuterType=t.phetioOuterType}static validateParameters(e,t){A(e,{valueType:Array});for(var i=!1,r=0;r<e.length;r++){var a=e[r];for(var n in i=i||a.phetioPrivate,a);b.validateValidator(a)}}getPhetioData(...e){var t=null;if(this._parameters.length>0){t={};for(var i=0;i<this._parameters.length;i++){var r=this._parameters[i];r.phetioPrivate||(t[r.name]=r.phetioType.toStateObject(e[i]))}}return t}static getPhetioDocumentation(e,t){return e+(0===t.length?"<br>No parameters.":"".concat("<br>The parameters are:<br/><ol>").concat(t.map(e=>{var t=e.phetioDocumentation?" - ".concat(e.phetioDocumentation):"";return"<li>".concat(e.name,": ").concat(e.phetioType.typeName).concat(t,"</li>")}).join("<br/>"),"</ol>"))}execute(...e){this.phetioStartEvent("emitted",{getData:()=>this.getPhetioData(...e)}),this._action.apply(null,e),this.phetioEndEvent()}}var Me=e=>e.typeName,xe=new Map;Le.ActionIO=e=>{var t=e.map(Me).join(",");return xe.has(t)||xe.set(t,new B("ActionIO<".concat(e.map(Me).join(", "),">"),{valueType:Le,documentation:"Executes when an event occurs",events:["emitted"],parameterTypes:e,metadataDefaults:{phetioState:!1},methods:{execute:{returnType:Se,parameterTypes:e,implementation:function(...e){this.execute(...e)},documentation:"Executes the function the Action is wrapping.",invocableForReadOnlyElements:!1}}})),xe.get(t)},h.register("Action",Le);var Ve=Le,Ce=new B("BooleanIO",{supertype:he,valueType:"boolean",documentation:"IO Type for Javascript's boolean primitive type",stateSchema:R.asValue("boolean",{valueType:"boolean"})});N.register("BooleanIO",Ce);var Re=Ce,ke=new Map,Fe=e=>(ke.has(e)||ke.set(e,new B("ArrayIO<".concat(e.typeName,">"),{valueType:Array,isValidValue:t=>_.every(t,t=>b.isValueValid(t,e.validator)),parameterTypes:[e],toStateObject:t=>t.map(e.toStateObject),fromStateObject:t=>t.map(e.fromStateObject),documentation:"IO Type for the built-in JS array type, with the element type specified.",stateSchema:R.asValue("Array<".concat(e.typeName,">"),{isValidValue:t=>_.every(t,t=>e.isStateObjectValid(t))})})),ke.get(e));N.register("ArrayIO",Fe);var je=Fe,Ue=new Map,Be=(e,t)=>{for(var i=0;i<t.length;i++);var r="".concat(e.typeName,".").concat(t.map(e=>e.typeName).join(","));if(!Ue.has(r)){var a=t.map(e=>e.typeName).join(", ");""===a&&(a="none");var n=t.map(e=>e.typeName).join(",");Ue.set(r,new B("FunctionIO(".concat(n,")=>").concat(e.typeName),{valueType:"function",isFunctionType:!0,parameterTypes:t.concat([e]),documentation:"".concat("Wrapper for the built-in JS function type.<br><strong>Arguments:</strong> ").concat(a,"<br>")+"<strong>Return Type:</strong> ".concat(e.typeName)}))}return Ue.get(r)};N.register("FunctionIO",Be);var ze=Be,He=new Map,qe=e=>(He.has(e)||He.set(e,new B("NullableIO<".concat(e.typeName,">"),{documentation:"An IOType adding support for null in addition to the behavior of its parameter.",isValidValue:t=>null===t||b.isValueValid(t,e.validator),parameterTypes:[e],toStateObject:t=>null===t?null:e.toStateObject(t),fromStateObject:t=>null===t?null:e.fromStateObject(t),stateSchema:R.asValue("null|<".concat(e.typeName,">"),{isValidValue:t=>null===t||e.isStateObjectValid(t)})})),He.get(e));N.register("NullableIO",qe);var Ge=qe,Ye=e=>e.get();class We{constructor(e,t,i){this.dependencies=e,this.dependencyListeners=new Map,e.forEach(i=>{var r=()=>{this.isDisposed||t(...e.map(Ye))};this.dependencyListeners.set(i,r),i.lazyLink(r,{phetioDependencies:_.without(e,i)})}),i||t(...e.map(Ye)),this.isDisposed=!1}dispose(){for(var e=0;e<this.dependencies.length;e++){var t=this.dependencies[e],i=this.dependencyListeners.get(t);t.hasListener(i)&&t.unlink(i)}this.dependencies=null,this.dependencyListeners.clear(),this.dependencyListeners=null,this.isDisposed=!0}}h.register("Multilink",We);var Xe=We,Ke=g.byKeys(["UNDEFER","NOTIFY"]);h.register("PropertyStatePhase",Ke);var Je=Ke;class Qe{constructor(e){this.phaseCallbackSets=new et,this.undeferBeforeUndeferMapPair=new $e(Je.UNDEFER,Je.UNDEFER),this.undeferBeforeNotifyMapPair=new $e(Je.UNDEFER,Je.NOTIFY),this.notifyBeforeUndeferMapPair=new $e(Je.NOTIFY,Je.UNDEFER),this.notifyBeforeNotifyMapPair=new $e(Je.NOTIFY,Je.NOTIFY),this.mapPairs=[this.undeferBeforeUndeferMapPair,this.undeferBeforeNotifyMapPair,this.notifyBeforeUndeferMapPair,this.notifyBeforeNotifyMapPair],this.initialized=!1}initialize(e){e.onBeforeApplyStateEmitter.addListener(e=>{if(e instanceof ht&&!e.isDeferred){e.setDeferred(!0);var t=e.tandem.phetioID;this.phaseCallbackSets.addUndeferPhaseCallback(new Ze(t,()=>{var i=e.setDeferred(!1);this.phaseCallbackSets.addNotifyPhaseCallback(new Ze(t,i,Je.NOTIFY))},Je.UNDEFER))}}),e.stateSetEmitter.addListener(e=>{this.undeferAndNotifyProperties(new Set(Object.keys(e)))}),e.isSettingStateProperty.lazyLink(e=>{}),this.initialized=!0}validateInstrumentedProperty(e){}validatePropertyPhasePair(e,t){this.validateInstrumentedProperty(e)}getMapPairFromPhases(e,t){var i=this.mapPairs.filter(i=>e===i.beforePhase&&t===i.afterPhase);return i[0]}registerPhetioOrderDependency(e,t,i,r){oe.PHET_IO_ENABLED&&(this.validatePropertyPhasePair(e,t),this.validatePropertyPhasePair(i,r),this.getMapPairFromPhases(t,r).addOrderDependency(e.tandem.phetioID,i.tandem.phetioID))}propertyInAnOrderDependency(e){return this.validateInstrumentedProperty(e),_.some(this.mapPairs,t=>t.usesPhetioID(e.tandem.phetioID))}unregisterOrderDependenciesForProperty(e){oe.PHET_IO_ENABLED&&(this.validateInstrumentedProperty(e),this.propertyInAnOrderDependency(e)&&this.mapPairs.forEach(t=>t.unregisterOrderDependenciesForProperty(e)))}undeferAndNotifyProperties(e){for(var t={},i=0;this.phaseCallbackSets.size>0;)++i>5e3&&this.errorInUndeferAndNotifyStep(t),this.attemptToApplyPhases(Je.UNDEFER,t,e),this.attemptToApplyPhases(Je.NOTIFY,t,e)}errorInUndeferAndNotifyStep(e){var t=[];this.phaseCallbackSets.forEach(e=>t.push(e.getTerm()));var i=[];this.mapPairs.forEach(e=>{var r=e.beforeMap,a=function(e,a){a.forEach(a=>{var n=e+r.beforePhase,s=a+r.afterPhase;(t.includes(n)||t.includes(s))&&i.push({beforeTerm:n,afterTerm:s})})};for(var[n,s]of r)a(n,s)});var r="";console.log("still to be undeferred",this.phaseCallbackSets.undeferSet),console.log("still to be notified",this.phaseCallbackSets.notifySet),console.log("order dependencies that apply to the still todos",i),i.forEach(e=>{r+="".concat(e.beforeTerm,"\t").concat(e.afterTerm,"\n")}),console.log("\n\nin graphable form:\n\n",r);var a="Impossible set state: from undeferAndNotifyProperties; ordering constraints cannot be satisfied";throw new Error(a)}getNumberOfOrderDependencies(){var e=0;return this.mapPairs.forEach(t=>{t.afterMap.forEach(t=>{e+=t.size})}),e}attemptToApplyPhases(e,t,i){var r=this.phaseCallbackSets.getSetFromPhase(e);for(var a of r)this.phetioIDCanApplyPhase(a.phetioID,e,t,i)&&(a.listener(),r.delete(a),t[a.getTerm()]=!0)}phetioIDCanApplyPhase(e,t,i,r){if(t===Je.NOTIFY&&!i[e+Je.UNDEFER])return!1;var a=[];this.mapPairs.forEach(e=>{e.afterPhase===t&&a.push(e.afterMap)});for(var n=0;n<a.length;n++){var s=a[n];if(!s.has(e))return!0;var o=s.get(e);for(var l of o)if(!i[l+s.beforePhase]&&r.has(l)&&r.has(e))return!1}return!0}}class Ze{constructor(e,t,i){this.phetioID=e,this.phase=i,this.listener=t||_.noop}getTerm(){return this.phetioID+this.phase}}class $e{constructor(e,t){this.beforeMap=new Map,this.beforeMap.beforePhase=e,this.beforeMap.afterPhase=t,this.afterMap=new Map,this.afterMap.beforePhase=e,this.afterMap.afterPhase=t,this.beforeMap.otherMap=this.afterMap,this.afterMap.otherMap=this.beforeMap,this.beforePhase=e,this.afterPhase=t}addOrderDependency(e,t){this.beforeMap.has(e)||this.beforeMap.set(e,new Set),this.beforeMap.get(e).add(t),this.afterMap.has(t)||this.afterMap.set(t,new Set),this.afterMap.get(t).add(e)}unregisterOrderDependenciesForProperty(e){var t=e.tandem.phetioID;[this.beforeMap,this.afterMap].forEach(e=>{e.has(t)&&e.get(t).forEach(i=>{var r=e.otherMap.get(i);r&&r.delete(t),0===r.size&&e.otherMap.delete(i)}),e.delete(t)})}usesPhetioID(e){return this.beforeMap.has(e)||this.afterMap.has(e)}}class et{constructor(){this.undeferSet=new Set,this.notifySet=new Set}get size(){return this.undeferSet.size+this.notifySet.size}forEach(e){this.undeferSet.forEach(e),this.notifySet.forEach(e)}addUndeferPhaseCallback(e){this.undeferSet.add(e)}addNotifyPhaseCallback(e){this.notifySet.add(e)}getSetFromPhase(e){return e===Je.NOTIFY?this.notifySet:this.undeferSet}}h.register("PropertyStateHandler",Qe);var tt=new Qe;h.register("propertyStateHandlerSingleton",tt);var it=tt;class rt extends u{constructor(e,t){super(t),this._value=e}get(){return this._value}get value(){return this.get()}set(e){if(!this.equalsValue(e)){var t=this._value;this.setPropertyValue(e),this.notifyListeners(t)}return this}set value(e){this.set(e)}setPropertyValue(e){this._value=e}equalsValue(e){return this.areValuesEqual(e,this._value)}areValuesEqual(e,t){return this.useDeepEquality&&e&&t&&e.constructor===t.constructor?e.equals(t):e===t}notifyListeners(e){this.emit(this._value,e,this)}link(e){this.addListener(e),e(this._value,null,this)}lazyLink(e){this.addListener(e)}unlink(e){this.removeListener(e)}unlinkAll(){this.removeAllListeners()}linkAttribute(e,t){var i=i=>{e[t]=i};return this.link(i),i}unlinkAttribute(e){this.unlink(e)}isPhetioInstrumented(){return!1}isSettable(){return!0}dispose(){this.unlinkAll(),super.dispose()}}h.register("TinyProperty",rt);var at=rt,nt={values:["%","A","AMU","atm","cm","cm^2","C","°","°C","F","g","Hz","J","K","kg","kg/m^3","kg·m/s","kPa","L","L/s","m","m/s","m/s/s","m/s^2","mA","mm","mol","mol/L","N","N/m","nm","nm/ps","N·s/m","Ω","Ω·cm","particles/ps","pm","pm/ps","pm/s","pm/s^2","pm^3","ps","radians","radians/s","s","V","view-coordinates/s"],isValidUnits:function(e){return _.includes(nt.values,e)}};h.register("units",nt);var st=0;class ot extends Ie{constructor(e,t){t=l({tandem:oe.OPTIONAL,useDeepEquality:!1,units:null,reentrant:!1,onBeforeNotify:null},t),b.containsValidatorKey(t)||(t.isValidValue=()=>!0),t.units&&(t.phetioEventMetadata=t.phetioEventMetadata||{},t.phetioEventMetadata.units=t.units),super(t),this.id=st++,this.units=t.units,oe.VALIDATION&&this.isPhetioInstrumented(),this._initialValue=e,this.validValues=t.validValues,this.tinyProperty=new at(e,t.onBeforeNotify),this.tinyProperty.useDeepEquality=t.useDeepEquality,this.notifying=!1,this.reentrant=t.reentrant,this.isDeferred=!1,this.deferredValue=null,this.hasDeferredValue=!1}isSettable(){return!0}get(){return this.tinyProperty.get()}set(e){if(!this.isDisposed)if(this.isDeferred)this.deferredValue=e,this.hasDeferredValue=!0;else if(!this.equalsValue(e)){var t=this.get();this.setPropertyValue(e),this._notifyListeners(t)}return this}setPropertyValue(e){this.tinyProperty.setPropertyValue(e)}setInitialValue(e){this._initialValue=e}equalsValue(e){return this.areValuesEqual(e,this.get())}areValuesEqual(e,t){return this.tinyProperty.areValuesEqual(e,t)}getInitialValue(){return this._initialValue}get initialValue(){return this.getInitialValue()}_notifyListeners(e){var t=this.get();this.phetioStartEvent(ot.CHANGED_EVENT_NAME,{getData:()=>{var i=this.phetioType.parameterTypes[0];return{oldValue:Ge(i).toStateObject(e),newValue:i.toStateObject(t)}}}),this.notifying=!0,this.tinyProperty.emit(t,e,this),this.notifying=!1,this.phetioEndEvent()}notifyListenersStatic(){this._notifyListeners(null)}setDeferred(e){if(e)this.isDeferred=!0;else{this.isDeferred=!1;var t=this.get();if(this.hasDeferredValue&&(this.setPropertyValue(this.deferredValue),this.hasDeferredValue=!1),!this.equalsValue(t))return()=>!this.isDisposed&&this._notifyListeners(t)}return null}reset(){this.set(this._initialValue)}get value(){return this.get()}set value(e){this.set(e)}addPhetioStateDependencies(e){for(var t=0;t<e.length;t++){var i=e[t];i instanceof ot&&i.isPhetioInstrumented()&&this.isPhetioInstrumented()&&it.registerPhetioOrderDependency(i,Je.UNDEFER,this,Je.NOTIFY)}}link(e,t){t&&t.phetioDependencies&&this.addPhetioStateDependencies(t.phetioDependencies),this.tinyProperty.addListener(e),e(this.get(),null,this)}lazyLink(e,t){t&&t.phetioDependencies&&this.addPhetioStateDependencies(t.phetioDependencies),this.tinyProperty.lazyLink(e)}unlink(e){this.tinyProperty.unlink(e)}unlinkAll(){this.tinyProperty.unlinkAll()}linkAttribute(e,t){var i=i=>{e[t]=i};return this.link(i),i}unlinkAttribute(e){this.unlink(e)}toString(){return"Property#".concat(this.id,"{").concat(this.get(),"}")}valueOf(){return this.toString()}debug(e){var t=t=>console.log(e,t);return this.link(t),t}toggle(){this.value=!this.value}dispose(){this.isPhetioInstrumented()&&it.unregisterOrderDependenciesForProperty(this),super.dispose(),this.tinyProperty.dispose()}hasListener(e){return this.tinyProperty.hasListener(e)}getListenerCount(){return this.tinyProperty.getListenerCount()}forEachListener(e){this.tinyProperty.forEachListener(e)}hasListeners(){return this.tinyProperty.hasListeners()}static multilink(e,t){return new Xe(e,t,!1)}static lazyMultilink(e,t){return new Xe(e,t,!0)}static unmultilink(e){e.dispose()}}ot.CHANGED_EVENT_NAME="changed";var lt=new Map;ot.PropertyIO=e=>(lt.has(e)||lt.set(e,new B("PropertyIO<".concat(e.typeName,">"),{valueType:ot,documentation:"Observable values that send out notifications when the value changes. This differs from the traditional listener pattern in that added listeners also receive a callback with the current value when the listeners are registered. This is a widely-used pattern in PhET-iO simulations.",methodOrder:["link","lazyLink"],events:["changed"],parameterTypes:[e],toStateObject:t=>{var i={value:e.toStateObject(t.value)};return t.validValues?i.validValues=t.validValues.map(t=>e.toStateObject(t)):i.validValues=null,i.units=Ge(ue).toStateObject(t.units),i},applyState:(t,i)=>{t.units=Ge(ue).fromStateObject(i.units),t.set(e.fromStateObject(i.value)),i.validValues&&(t.validValues=i.validValues.map(t=>e.fromStateObject(t)))},stateSchema:{value:e,validValues:Ge(je(e)),units:Ge(ue)},methods:{getValue:{returnType:e,parameterTypes:[],implementation:function(){return this.get()},documentation:"Gets the current value."},setValue:{returnType:Se,parameterTypes:[e],implementation:function(e){this.set(e)},documentation:"Sets the value of the Property. If the value differs from the previous value, listeners are notified with the new value.",invocableForReadOnlyElements:!1},link:{returnType:Se,parameterTypes:[ze(Se,[e,Ge(e)])],implementation:function(e){this.link(e)},documentation:"Adds a listener which will be called when the value changes. On registration, the listener is also called with the current value. The listener takes two arguments, the new value and the previous value."},lazyLink:{returnType:Se,parameterTypes:[ze(Se,[e,Ge(e)])],implementation:function(e){this.lazyLink(e)},documentation:'Adds a listener which will be called when the value changes. This method is like "link", but without the current-value callback on registration. The listener takes two arguments, the new value and the previous value.'},unlink:{returnType:Se,parameterTypes:[ze(Se,[e])],implementation:function(e){this.unlink(e)},documentation:"Removes a listener."}}})),lt.get(e)),h.register("Property",ot);var ht=ot,pt=ht.PropertyIO(Re);class ut extends ht{constructor(e,t){super(e,t=l({valueType:"boolean",phetioType:pt},t))}}h.register("BooleanProperty",ut);var dt=ut,ct=new c;h.register("stepTimer",ct);var mt=ct;class yt{constructor(e){e=l({callback:null,delay:400,interval:100},e),this.delay=e.delay,this.interval=e.interval,this.callbacks=[],e.callback&&this.callbacks.push(e.callback),this.delayID=null,this.intervalID=null,this.fired=!1}isRunning(){return null!==this.delayID||null!==this.intervalID}start(){this.isRunning()||(this.fired=!1,this.delayID=mt.setTimeout(()=>{this.delayID=null,this.intervalID=mt.setInterval(()=>this.fire(),this.interval),this.fire()},this.delay))}stop(e){this.isRunning()&&(this.delayID&&(mt.clearTimeout(this.delayID),this.delayID=null),this.intervalID&&(mt.clearInterval(this.intervalID),this.intervalID=null),e&&!this.fired&&this.fire())}addCallback(e){-1===this.callbacks.indexOf(e)&&this.callbacks.push(e)}removeCallback(e){var t=this.callbacks.indexOf(e);-1!==t&&this.callbacks.splice(t,1)}fire(){for(var e=this.callbacks.slice(0),t=0;t<e.length;t++)e[t]();this.fired=!0}dispose(){this.stop(!1),this.callbacks.length=0}}h.register("CallbackTimer",yt);var gt=(e,t)=>e(...t.map(e=>e.get()));class vt extends ht{constructor(e,t,i){i=l({tandem:oe.OPTIONAL,phetioReadOnly:!0},i),super(gt(t,e),i),oe.VALIDATION&&this.isPhetioInstrumented(),this.dependencies=e,this._initialValue=null,this.derivation=t,this.derivedPropertyListener=this.getDerivedPropertyListener.bind(this),e.forEach(e=>{e.lazyLink(this.derivedPropertyListener),e instanceof ht&&this.isPhetioInstrumented()&&e.isPhetioInstrumented()&&it.registerPhetioOrderDependency(e,Je.UNDEFER,this,Je.UNDEFER)})}isSettable(){return!1}getDerivedPropertyListener(){this.isDeferred?this.hasDeferredValue=!0:super.set(gt(this.derivation,this.dependencies))}dispose(){for(var e=0;e<this.dependencies.length;e++){var t=this.dependencies[e];t.hasListener(this.derivedPropertyListener)&&t.unlink(this.derivedPropertyListener)}this.dependencies=null,super.dispose()}set(e){throw new Error("Cannot set values directly to a DerivedProperty, tried to set: ".concat(e))}set value(e){throw new Error("Cannot es5-set values directly to a DerivedProperty, tried to set: ".concat(e))}reset(){throw new Error("Cannot reset a DerivedProperty directly")}getInitialValue(){throw new Error("Cannot get the initial value of a DerivedProperty")}setDeferred(e){return this.isDeferred&&!e&&(this.deferredValue=gt(this.derivation,this.dependencies)),super.setDeferred(e)}get value(){return super.get()}static valueEquals(e,t,i){return new vt([e,t],ft,i)}static and(e,t){return new vt(e,_.reduce.bind(null,e,Tt,!0),t)}static or(e,t){return new vt(e,_.reduce.bind(null,e,Et,!1),t)}static not(e,t){return new vt([e],e=>!e,t)}}var ft=(e,t)=>e===t,Tt=(e,t)=>e&&t.value,Et=(e,t)=>e||t.value,Pt=new Map;vt.DerivedPropertyIO=e=>(Pt.has(e)||Pt.set(e,new B("".concat("DerivedPropertyIO","<").concat(e.typeName,">"),{valueType:vt,parameterTypes:[e],supertype:ht.PropertyIO(e),documentation:"Like PropertyIO, but not settable.  Instead it is derived from other DerivedPropertyIO or PropertyIO instances",applyState:()=>{},methods:{setValue:{returnType:Se,parameterTypes:[e],implementation:function(e){return this.set(e)},documentation:"Errors out when you try to set a derived property.",invocableForReadOnlyElements:!1}}})),Pt.get(e)),h.register("DerivedProperty",vt);class bt extends ht{constructor(e,t){var i="string"==typeof(t=l({bidirectional:!1,defaultValue:null,derive:_.identity,map:_.identity,inverseMap:_.identity},t)).derive?_.property(t.derive):t.derive,r="string"==typeof t.map?_.property(t.map):t.map;super(null===e.value?r(t.defaultValue):r(i(e.value).value),t),this.defaultValue=t.defaultValue,this.derive=i,this.map=r,this.inverseMap="string"==typeof t.inverseMap?_.property(t.inverseMap):t.inverseMap,this.bidirectional=t.bidirectional,this.valuePropertyProperty=e,this.isExternallyChanging=!1,this.bidirectional||(this._initialValue=null),this.propertyPropertyListener=this.onPropertyPropertyChange.bind(this),this.propertyListener=this.onPropertyChange.bind(this),e.link(this.propertyListener),t.bidirectional&&this.lazyLink(this.onSelfChange.bind(this))}onPropertyPropertyChange(e,t,i){if(this.bidirectional&&null!==this.valuePropertyProperty.value&&i&&(this.derive(this.valuePropertyProperty.value)===i&&i.equalsValue(this.inverseMap(this.value))))return;super.set(this.map(e))}onPropertyChange(e,t){t&&this.derive(t).unlink(this.propertyPropertyListener),e?this.derive(e).link(this.propertyPropertyListener):this.onPropertyPropertyChange(this.defaultValue,null,null)}onSelfChange(e){if(null!==this.valuePropertyProperty.value){var t=this.derive(this.valuePropertyProperty.value);this.areValuesEqual(e,this.map(t.value))||(t.value=this.inverseMap(e))}}dispose(){this.valuePropertyProperty.unlink(this.propertyListener),null!==this.valuePropertyProperty.value&&this.derive(this.valuePropertyProperty.value).unlink(this.propertyPropertyListener),super.dispose()}reset(){null!==this.valuePropertyProperty.value&&this.derive(this.valuePropertyProperty.value).reset()}getInitialValue(){return super.getInitialValue()}set(e){this.isExternallyChanging=!0,super.set(e),this.isExternallyChanging=!1}isSettable(){return super.isSettable()&&this.bidirectional}}h.register("DynamicProperty",bt);class Ot extends Ve{constructor(e){super((...e)=>{t.tinyEmitter.emit(...e)},e=l({phetioOuterType:Ot.EmitterIO,onBeforeNotify:null},e));var t=this;this.tinyEmitter=new u(e.onBeforeNotify)}execute(){}emit(...e){super.execute.apply(this,e)}dispose(){this.tinyEmitter.dispose(),super.dispose()}addListener(e){this.tinyEmitter.addListener(e)}removeListener(e){this.tinyEmitter.removeListener(e)}removeAllListeners(){this.tinyEmitter.removeAllListeners()}hasListener(e){return this.tinyEmitter.hasListener(e)}hasListeners(){return this.tinyEmitter.hasListeners()}getListenerCount(){return this.tinyEmitter.getListenerCount()}}var At=e=>e.typeName,It=new Map;Ot.EmitterIO=e=>{var t=e.map(At).join(",");return It.has(t)||It.set(t,new B("EmitterIO<".concat(e.map(At).join(", "),">"),{valueType:Ot,supertype:Ve.ActionIO(e),documentation:"Emits when an event occurs and calls added listeners.",parameterTypes:e,methods:{addListener:{returnType:Se,parameterTypes:[ze(Se,e)],implementation:function(e){this.addListener(e)},documentation:"Adds a listener which will be called when the emitter emits."},removeListener:{returnType:Se,parameterTypes:[ze(Se,e)],implementation:function(e){this.removeListener(e)},documentation:"Remove a listener."},emit:{returnType:Se,parameterTypes:e,implementation:function(...e){this.emit(...e)},documentation:"Emits a single event to all listeners.",invocableForReadOnlyElements:!1}}})),It.get(t)},h.register("Emitter",Ot);var wt=Ot;class St extends ht{constructor(e,t,i){super(t,i=l({valueType:e,phetioType:ht.PropertyIO(q(e)),validValues:e.VALUES},i)),this.enumeration=e}}h.register("EnumerationProperty",St);var Dt=new B("NumberIO",{valueType:"number",documentation:"IO Type for Javascript's number primitive type",toStateObject:e=>e===Number.POSITIVE_INFINITY?"POSITIVE_INFINITY":e===Number.NEGATIVE_INFINITY?"NEGATIVE_INFINITY":e,fromStateObject:e=>"POSITIVE_INFINITY"===e?Number.POSITIVE_INFINITY:"NEGATIVE_INFINITY"===e?Number.NEGATIVE_INFINITY:e,stateSchema:R.asValue("'POSITIVE_INFINITY'|'NEGATIVE_INFINITY'|number",{isValidValue:e=>"POSITIVE_INFINITY"===e||"NEGATIVE_INFINITY"===e||"number"==typeof e})});N.register("NumberIO",Dt);var _t=Dt,Nt=new t("dot");Nt.register("v2",(e,t)=>new Nt.Vector2(e,t)),Nt.register("v3",(e,t,i)=>new Nt.Vector3(e,t,i)),Nt.register("v4",(e,t,i,r)=>new Nt.Vector4(e,t,i,r)),Nt.register("FastArray",window.Float64Array?window.Float64Array:window.Array);var Lt=Nt;class Mt{constructor(e,t){this._min=e,this._max=t}getMin(){return this._min}get min(){return this.getMin()}setMin(e){this._min=e}set min(e){this.setMin(e)}getMax(){return this._max}get max(){return this.getMax()}setMax(e){this._max=e}set max(e){this.setMax(e)}setMinMax(e,t){this._min=e,this._max=t}copy(){return new Mt(this._min,this._max)}getLength(){return this._max-this._min}getCenter(){return(this._max+this._min)/2}contains(e){return e>=this._min&&e<=this._max}containsRange(e){return this._min<=e.min&&this._max>=e.max}intersects(e){return this._max>=e.min&&e.max>=this._min}intersectsExclusive(e){return this._max>e.min&&e.max>this._min}toString(){return"[Range (min:".concat(this._min," max:").concat(this._max,")]")}constrainValue(e){return Math.min(Math.max(e,this._min),this._max)}equals(e){return this.constructor===e.constructor&&this._min===e.min&&this._max===e.max}getNormalizedValue(e){return(e-this.min)/this.getLength()}get defaultValue(){throw new Error("defaultValue is undefined, did you mean to use RangeWithValue?")}}Lt.register("Range",Mt),Mt.RangeIO=new B("RangeIO",{valueType:Mt,documentation:'A range with "min" and a "max" members.',toStateObject:e=>({min:_t.toStateObject(e.min),max:_t.toStateObject(e.max)}),fromStateObject:e=>new Mt(_t.fromStateObject(e.min),_t.fromStateObject(e.max)),stateSchema:{min:_t,max:_t}});var xt=Mt,Vt=["FloatingPoint","Integer"],Ct=ht.PropertyIO(_t);class Rt extends ht{constructor(e,t){t=l({numberType:"FloatingPoint",range:null,step:null,rangePropertyOptions:{phetioDocumentation:"provides the range of possible values for the parent NumberProperty",phetioType:ht.PropertyIO(Ge(xt.RangeIO)),phetioReadOnly:!0},tandem:oe.OPTIONAL},t),(t=l({rangePropertyOptions:{tandem:t.tandem.createTandem("rangeProperty")}},t)).valueType="number",t.phetioType=Rt.NumberPropertyIO;var i=!(t.range&&t.range instanceof ht);super(e,t),this.numberType=t.numberType,this.step=t.step,this.validateNumberProperty=!1,this.rangeProperty=null,this.rangeProperty=i?new ht(t.range,t.rangePropertyOptions):t.range;var r=e=>{this.validateNumberProperty&&this.validateNumberProperty(this.value)};this.rangeProperty.link(r),this.rangeProperty.addPhetioStateDependencies([this]),this.addPhetioStateDependencies([this.rangeProperty]),t.validValues&&this.validateNumberProperty&&t.validValues.forEach(e=>this.validateNumberProperty(e)),this.validateNumberProperty&&this.link(e=>{this.validateNumberProperty(e)}),this.disposeNumberProperty=()=>{i?this.rangeProperty.dispose():this.rangeProperty.unlink(r)},this.resetNumberProperty=()=>{i&&this.rangeProperty.reset()}}get range(){return this.rangeProperty.value}set range(e){this.rangeProperty.value=e}reset(){super.reset(),this.resetNumberProperty()}dispose(){this.disposeNumberProperty(),super.dispose()}setValueAndRange(e,t){this.setDeferred(!0),this.rangeProperty.setDeferred(!0),this.set(e),this.rangeProperty.set(t);var i=this.setDeferred(!1),r=this.rangeProperty.setDeferred(!1);i&&i(),r&&r()}resetValueAndRange(){this.setValueAndRange(this.initialValue,this.rangeProperty.initialValue)}}Rt.NumberPropertyIO=new B("NumberPropertyIO",{valueType:Rt,supertype:Ct,parameterTypes:[_t],documentation:"Extends PropertyIO to add values for the numeric range ( min, max ) and numberType ( '".concat(Vt.join("' | '"),"' )"),toStateObject:e=>{var t=Ct.toStateObject(e);t.numberType=ue.toStateObject(e.numberType),t.range=Ge(xt.RangeIO).toStateObject(e.rangeProperty.value);var i=e.rangeProperty&&e.rangeProperty.isPhetioInstrumented();return t.rangePhetioID=i?ue.toStateObject(e.rangeProperty.tandem.phetioID):null,t.step=Ge(_t).toStateObject(e.step),t},applyState:(e,t)=>{Ct.applyState(e,t),e.step=t.step,e.numberType=t.numberType},stateSchema:{numberType:ue,range:Ge(xt.RangeIO),rangePhetioID:Ge(ue),step:Ge(_t),value:_t}}),h.register("NumberProperty",Rt);var kt=Rt,Ft=e=>{s(e,["length"],["elements"]);var t=null;if((e=l({length:0,elements:[],tandem:oe.OPTIONAL},e)).phetioType)t={name:"value",phetioType:e.phetioType.parameterTypes[0]};else if(b.isValidValidator(e)){var i=_.pick(e,b.VALIDATOR_KEYS);t=l({name:"value"},i)}else t=l({name:"value"},{isValidValue:_.stubTrue});var r=new wt({tandem:e.tandem.createTandem("elementAddedEmitter"),parameters:[t]}),a=new wt({tandem:e.tandem.createTandem("elementRemovedEmitter"),parameters:[t]}),n=new kt(0,{numberType:"Integer",tandem:e.tandem.createTandem("lengthProperty"),phetioReadOnly:!0}),o=[],h=new Proxy(o,{get:function(e,t,i){return Ut.hasOwnProperty(t)?Ut[t]:Reflect.get(e,t,i)},set:function(e,t,i){var s=e[t],o=null;"length"===t&&(o=e.slice(i));var l=Reflect.set(e,t,i),h=Number(t);return Number.isInteger(h)&&h>=0&&s!==i?(n.value=e.length,void 0!==s&&a.emit(e[t]),void 0!==i&&r.emit(i)):"length"===t&&(n.value=i,o&&o.forEach(e=>a.emit(e))),l},deleteProperty:function(e,t){var i,r=Number(t);Number.isInteger(r)&&r>=0&&(i=e[t]);var n=Reflect.deleteProperty(e,t);return void 0!==i&&a.emit(i),n}});h.targetArray=o,h.elementAddedEmitter=r,h.elementRemovedEmitter=a,h.lengthProperty=n;var p=()=>{e.length>=0&&(h.length=e.length),e.elements.length>0&&Array.prototype.push.apply(h,e.elements)};return p(),h.reset=()=>{h.length=0,p()},e.tandem.supplied&&(h.phetioElementType=e.phetioType.parameterTypes[0],h.observableArrayPhetioObject=new jt(h,e)),h};class jt extends Ie{constructor(e,t){super(t=l({phetioType:Ht},t)),this.observableArray=e}}var Ut={pop(...e){var t=this.targetArray.length,i=Array.prototype.pop.apply(this.targetArray,e);return this.lengthProperty.value=this.length,t>0&&this.elementRemovedEmitter.emit(i),i},shift(...e){var t=this.targetArray.length,i=Array.prototype.shift.apply(this.targetArray,e);return this.lengthProperty.value=this.length,t>0&&this.elementRemovedEmitter.emit(i),i},push(...e){var t=Array.prototype.push.apply(this.targetArray,e);this.lengthProperty.value=this.length;for(var i=0;i<arguments.length;i++)this.elementAddedEmitter.emit(e[i]);return t},unshift(...e){var t=Array.prototype.unshift.apply(this.targetArray,e);this.lengthProperty.value=this.length;for(var i=0;i<e.length;i++)this.elementAddedEmitter.emit(e[i]);return t},splice(...e){var t=Array.prototype.splice.apply(this.targetArray,e);this.lengthProperty.value=this.length;for(var i=t,r=2;r<e.length;r++)this.elementAddedEmitter.emit(e[r]);return i.forEach(e=>this.elementRemovedEmitter.emit(e)),t},copyWithin(...e){var t=this.targetArray.slice(),i=Array.prototype.copyWithin.apply(this.targetArray,e);return Bt(t,this),i},fill(...e){var t=this.targetArray.slice(),i=Array.prototype.fill.apply(this.targetArray,e);return Bt(t,this),i},get:function(e){return this[e]},addItemAddedListener:function(e){this.elementAddedEmitter.addListener(e)},removeItemAddedListener:function(e){this.elementAddedEmitter.removeListener(e)},addItemRemovedListener:function(e){this.elementRemovedEmitter.addListener(e)},removeItemRemovedListener:function(e){this.elementRemovedEmitter.removeListener(e)},add:function(e){this.push(e)},addAll:function(e){this.push(...e)},remove:function(e){w(this,e)},removeAll:function(e){e.forEach(e=>w(this,e))},clear:function(){for(;this.length>0;)this.pop()},count:function(e){for(var t=0,i=0;i<this.length;i++)e(this[i])&&t++;return t},find:function(e,t){return _.find(this,e,t)},shuffle:function(e){var t=e.shuffle(this);this.targetArray.length=0,Array.prototype.push.apply(this.targetArray,t)},getArrayCopy:function(){return this.slice()},dispose:function(){this.elementAddedEmitter.dispose(),this.elementRemovedEmitter.dispose(),this.lengthProperty.dispose(),this.observableArrayPhetioObject&&this.observableArrayPhetioObject.dispose()},toStateObject:function(){return{array:this.map(e=>this.phetioElementType.toStateObject(e))}},applyState:function(e){this.length=0;var t=e.array.map(e=>this.phetioElementType.fromStateObject(e));this.push(...t)}},Bt=(e,t)=>{for(var i=e,r=t.targetArray.slice(),a=0;a<i.length;a++){var n=i[a],s=r.indexOf(n);s>=0&&(i.splice(a,1),r.splice(s,1),a--)}i.forEach(e=>t.elementRemovedEmitter.emit(e)),r.forEach(e=>t.elementAddedEmitter.emit(e))},zt=new Map,Ht=e=>(zt.has(e)||zt.set(e,new B("ObservableArrayIO<".concat(e.typeName,">"),{valueType:jt,parameterTypes:[e],toStateObject:e=>e.observableArray.toStateObject(),applyState:(e,t)=>e.observableArray.applyState(t),stateSchema:{array:je(e)}})),zt.get(e));Ft.ObservableArrayIO=Ht,h.register("createObservableArray",Ft);var qt=ht.PropertyIO(ue);class Gt extends ht{constructor(e,t){super(e,t=l({valueType:"string",phetioType:qt},t))}}h.register("StringProperty",Gt);class Yt extends at{constructor(e,t,i){super(e,i),t&&(this.targetPropertyInstrumented=t)}setTargetProperty(e,t,i){if(this.targetProperty===i)return e;this.targetProperty&&this.targetProperty.isPhetioInstrumented();var r=this.targetProperty;this.ownedPhetioProperty&&i!==this.ownedPhetioProperty&&this.disposeOwnedPhetioProperty(),e&&e.updateLinkedElementForProperty(t,r,i),this.forwardingListener=this.forwardingListener||this.onTargetPropertyChange.bind(this);var a=this.get();this.targetProperty&&this.targetProperty.unlink(this.forwardingListener),this.targetProperty=i,this.targetProperty?this.targetProperty.lazyLink(this.forwardingListener):this._value=a;var n=this.get();return this.areValuesEqual(a,n)||this.notifyListeners(a),e}onTargetPropertyChange(e,t){this.notifyListeners(t)}get(){return this.targetProperty?this.targetProperty.value:super.get()}set(e){return this.targetProperty?this.targetProperty.set(e):super.set(e),this}notifyListeners(e){this.emit(this.get(),e,this)}link(e){this.addListener(e),e(this.get(),null,this)}setTargetPropertyInstrumented(e,t){return this.targetPropertyInstrumented=e,t}getTargetPropertyInstrumented(){return this.targetPropertyInstrumented}initializePhetio(e,t,i){!this.targetProperty&&this.targetPropertyInstrumented?(this.ownedPhetioProperty=i(),this.setTargetProperty(e,t,this.ownedPhetioProperty)):this.targetProperty&&this.targetProperty.isPhetioInstrumented()&&e.updateLinkedElementForProperty(t,null,this.targetProperty)}disposeOwnedPhetioProperty(){this.ownedPhetioProperty&&(this.ownedPhetioProperty.dispose(),delete this.ownedPhetioProperty)}dispose(){this.targetProperty&&this.targetProperty.unlink(this.forwardingListener),this.disposeOwnedPhetioProperty(),super.dispose()}}h.register("TinyForwardingProperty",Yt);class Wt extends at{constructor(e,t){super(e),this.onAccessAttempt=t}get(){return this.onAccessAttempt(),super.get()}set(e){throw new Error("Cannot set a TinyStaticProperty value")}isSettable(){return!1}notifyListeners(e){this.emit(this.get(),e,this)}link(e){this.addListener(e),e(this.get(),null,this)}equalsValue(e){return this.areValuesEqual(e,this.get())}}h.register("TinyStaticProperty",Wt);function Xt(e,t,i,r,a){i=i||[],r=r||[],a=a||[],Array.prototype.push.apply(i,e),Array.prototype.push.apply(r,t);e:for(var n=0;n<i.length;n++)for(var s=i[n],o=0;o<r.length;o++){if(s===r[o]){if(a.push(s),i.splice(n,1),r.splice(o,1),o=0,n===i.length)break e;n-=1}}return i}a.register("arrayDifference",Xt);function Kt(e){if(e){for(;e.length;)e.pop();return e}return[]}a.register("cleanArray",Kt);function Jt(e){var t=[];return e(e=>{t.push(e)}),t}a.register("collect",Jt);function Qt(e,t){return void 0!==e[t]?t:(t=t.charAt(0).toUpperCase()+t.slice(1),void 0!==e["moz".concat(t)]?"moz".concat(t):void 0!==e["Moz".concat(t)]?"Moz".concat(t):void 0!==e["webkit".concat(t)]?"webkit".concat(t):void 0!==e["ms".concat(t)]?"ms".concat(t):void 0!==e["o".concat(t)]?"o".concat(t):void 0)}a.register("detectPrefix",Qt);function Zt(e,t,i){return void 0!==e["on".concat(t)]?t:void 0!==e["".concat("onmoz").concat(t)]?"moz".concat(t):void 0!==e["".concat("onMoz").concat(t)]?"Moz".concat(t):void 0!==e["".concat("onwebkit").concat(t)]?"webkit".concat(t):void 0!==e["".concat("onms").concat(t)]?"ms".concat(t):void 0!==e["".concat("ono").concat(t)]?"o".concat(t):void 0}a.register("detectPrefixEvent",Zt);function $t(e,t,i){var r=[];return function e(t,a){return a.forEach((a,n)=>{r.push(n),1===t?i(...[a].concat(r)):e(t-1,a),r.pop()})}(e,t)}a.register("dimensionForEach",$t);function ei(e,t,i){var r=[];return function e(t,a){return a.map((a,n)=>{r.push(n);var s=1===t?i(...[a].concat(r)):e(t-1,a);return r.pop(),s})}(e,t)}a.register("dimensionMap",ei);class ti{constructor(e,t){this._enumeration=e,e.VALUES.forEach(e=>{this[e]=t(e)})}get(e){return this[e]}set(e,t){this[e]=t}map(e){return new ti(this._enumeration,t=>e(this.get(t),t))}forEach(e){this._enumeration.VALUES.forEach(t=>e(this.get(t),t))}values(){return this._enumeration.VALUES.map(e=>this.get(e))}}a.register("EnumerationMap",ti);var ii=ti;function ri(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}a.register("escapeHTML",ri);class ai{constructor(e,t){this.eventModel=e,this.eventCallback=t,this.period=this.eventModel.getPeriodBeforeNextEvent(),this.timeBeforeNextEvent=this.period}step(e){for(;e>=this.timeBeforeNextEvent;)e-=this.timeBeforeNextEvent,this.period=this.eventModel.getPeriodBeforeNextEvent(),this.timeBeforeNextEvent=this.period,this.eventCallback(e);this.timeBeforeNextEvent-=e}getRatio(){return(this.period-this.timeBeforeNextEvent)/this.period}}a.register("EventTimer",ai);ai.ConstantEventModel=class{constructor(e){this.rate=e}getPeriodBeforeNextEvent(){return 1/this.rate}};ai.UniformEventModel=class{constructor(e,t){this.rate=e,this.pseudoRandomNumberSource=t}getPeriodBeforeNextEvent(){var e=this.pseudoRandomNumberSource();return 2*e/this.rate}};ai.PoissonEventModel=class{constructor(e,t){this.rate=e,this.pseudoRandomNumberSource=t}getPeriodBeforeNextEvent(){var e=this.pseudoRandomNumberSource();return-Math.log(e)/this.rate}};function ni(e){return _.each(Array.prototype.slice.call(arguments,1),t=>{if(t)for(var i in t)Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))}),e}a.register("extend",ni);var si=ni;function oi(e){return _.each(Array.prototype.slice.call(arguments,1),t=>{if(t)for(var i in t){var r=Object.getOwnPropertyDescriptor(t,i);!r||"function"!=typeof r.get&&void 0===t[i]||Object.defineProperty(e,i,r)}}),e}a.register("extendDefined",oi);function li(e){for(var t=[e],i=e.prototype;i&&(i=Object.getPrototypeOf(i));)i.constructor&&t.push(i.constructor);return t}a.register("inheritance",li);var hi=li;function pi(e,t){for(var i=[],r=2*e.length-1,a=0;a<r;a++)a%2==0?i.push(e[a/2]):i.push(t((a-1)/2));return i}a.register("interleave",pi);function ui(e){return"[object Array]"===Object.prototype.toString.call(e)}a.register("isArray",ui);function di(e){"string"==typeof e&&(e={src:e});var t=e.src,i=e.callback,r=void 0===e.async||e.async,a=void 0!==e.cacheBust&&e.cacheBust,n=!1,s=document.createElement("script");s.type="text/javascript",s.async=r,s.onload=s.onreadystatechange=function(){var e=this.readyState;e&&"complete"!==e&&"loaded"!==e||n||(n=!0,i&&i())},s.src=t+(a?"?random=".concat(Math.random().toFixed(10)):"");var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(s,o)}a.register("loadScript",di);function ci(e){var t=new Map;return i=>{if(t.has(i))return t.get(i);var r=e(i);return t.set(i,r),r}}a.register("memoize",ci);function mi(e,t,i){i&&_.each(t,t=>{void 0!==i[t]&&(e[t]=i[t])})}a.register("mutate",mi);function yi(e){var t=window.open(e,"_blank");t&&t.focus()}a.register("openPopup",yi);class gi{constructor(e,t,i,r,a,n,s,o,l,h,p){this.coordinate=e,this.centerCoordinate=t,this.minSide=i,this.maxSide=r,this.rectCoordinate=a,this.rectSize=n,this.layoutBoxOrientation=s,this.size=o,this.ariaOrientation=s,this.modelToView=l,this.viewToModel=h,this.toVector=p,this.opposite=null}}var vi=new gi("x","centerX","left","right","rectX","rectWidth","horizontal","width",(e,t)=>e.modelToViewX(t),(e,t)=>e.viewToModelX(t),(e,t,i)=>new i(e,t)),fi=new gi("y","centerY","top","bottom","rectY","rectHeight","vertical","height",(e,t)=>e.modelToViewY(t),(e,t)=>e.viewToModelY(t),(e,t,i)=>new i(t,e));vi.opposite=fi,fi.opposite=vi;var Ti=g.byMap({HORIZONTAL:vi,VERTICAL:fi});a.register("Orientation",Ti);var Ei=Ti;class Pi extends ii{constructor(e,t){super(Ei,i=>i===Ei.HORIZONTAL?e:t)}get horizontal(){return this.get(Ei.HORIZONTAL)}set horizontal(e){this.set(Ei.HORIZONTAL,e)}get vertical(){return this.get(Ei.VERTICAL)}set vertical(e){this.set(Ei.VERTICAL,e)}static create(e){return new Pi(e(Ei.HORIZONTAL),e(Ei.VERTICAL))}}a.register("OrientationPair",Pi);function bi(e){var t=[],i=e.length;if(i>1)for(var r=0;r<i-1;r++)for(var a=e[r],n=r+1;n<i;n++)t.push([a,e[n]]);return t}a.register("pairs",bi);function Oi(e,t){for(var i=[],r=[],a=e.length,n=0;n<a;n++)t(e[n])?i.push(e[n]):r.push(e[n]);return[i,r]}a.register("partition",Oi);var Ai=navigator.userAgent;function Ii(e){return Si()===e}function wi(){return!!(window.phet&&phet.chipper&&phet.chipper.queryParameters&&phet.chipper.queryParameters["phet-app"]||(Ai.match(/(iPod|iPhone|iPad)/)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>=2)&&Ai.match(/AppleWebKit/))}function Si(){var e=-1;return"Microsoft Internet Explorer"===navigator.appName?null!==new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(Ai)&&(e=parseFloat(RegExp.$1)):"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(Ai)&&(e=parseFloat(RegExp.$1)),e}var Di={firefox:Ai.toLowerCase().indexOf("firefox")>-1,mobileSafari:wi(),safari5:!!(Ai.match(/Version\/5\./)&&Ai.match(/Safari\//)&&Ai.match(/AppleWebKit/)),safari6:!!(Ai.match(/Version\/6\./)&&Ai.match(/Safari\//)&&Ai.match(/AppleWebKit/)),safari7:!!(Ai.match(/Version\/7\./)&&Ai.match(/Safari\//)&&Ai.match(/AppleWebKit/)),safari10:!!(Ai.match(/Version\/10\./)&&Ai.match(/Safari\//)&&Ai.match(/AppleWebKit/)),safari11:!!(Ai.match(/Version\/11\./)&&Ai.match(/Safari\//)&&Ai.match(/AppleWebKit/)),safari9:!!(Ai.match(/Version\/9\./)&&Ai.match(/Safari\//)&&Ai.match(/AppleWebKit/)),safari:wi()||!!(Ai.match(/Version\//)&&Ai.match(/Safari\//)&&Ai.match(/AppleWebKit/)),ie:-1!==Si(),ie9:Ii(9),ie10:Ii(10),ie11:Ii(11),android:Ai.indexOf("Android")>0,edge:!!Ai.match(/Edge\//),chromium:/chrom(e|ium)/.test(Ai.toLowerCase())&&!Ai.match(/Edge\//)};a.register("platform",Di);var _i=Di,Ni={mixInto(e,t){t=l({defaultArguments:[],initialize:e.prototype.initialize,maxSize:100,initialSize:0,useDefaultConstruction:!1},t);var i=[],r=t.maxSize,a=Function.prototype.bind.bind(e,e),n=a(...t.defaultArguments),s=t.initialize,o=t.useDefaultConstruction,h=e.prototype;for(si(e,{pool:i,dirtyFromPool:()=>i.length?i.pop():new n,createFromPool:function(...e){var t;return i.length?(t=i.pop(),s.apply(t,e)):o?(t=new n,s.apply(t,e)):t=new(a(...e)),t},get poolSize(){return i.length},set maxPoolSize(e){r=e},get maxPoolSize(){return r}}),si(h,{freeToPool:function(){i.length<r&&i.push(this)}});i.length<t.initialSize;)i.push(new n)}};a.register("Poolable",Ni);var Li=new t("kite");Li.register("svgNumber",e=>e.toFixed(20));var Mi=Li;window.sceneryLog=null;var xi=document.createElement("canvas"),Vi=xi.getContext("2d"),Ci="",Ri=new t("scenery");function ki(e){Ri.logString+="".concat(e.replace(/%c/g,""),"\n")}function Fi(...e){window.console&&window.console.log&&window.console.log(...Array.prototype.slice.call(e,0))}Ri.register("scratchCanvas",xi),Ri.register("scratchContext",Vi);var ji={dirty:{name:"dirty",style:"color: #888;"},bounds:{name:"bounds",style:"color: #888;"},hitTest:{name:"hitTest",style:"color: #888;"},hitTestInternal:{name:"hitTestInternal",style:"color: #888;"},PerfCritical:{name:"Perf",style:"color: #f00;"},PerfMajor:{name:"Perf",style:"color: #aa0;"},PerfMinor:{name:"Perf",style:"color: #088;"},PerfVerbose:{name:"Perf",style:"color: #888;"},Cursor:{name:"Cursor",style:""},Stitch:{name:"Stitch",style:""},StitchDrawables:{name:"Stitch",style:""},GreedyStitcher:{name:"Greedy",style:"color: #088;"},GreedyVerbose:{name:"Greedy",style:"color: #888;"},RelativeTransform:{name:"RelativeTransform",style:"color: #606;"},BackboneDrawable:{name:"Backbone",style:"color: #a00;"},CanvasBlock:{name:"Canvas",style:""},WebGLBlock:{name:"WebGL",style:""},Display:{name:"Display",style:""},DOMBlock:{name:"DOM",style:""},Drawable:{name:"",style:""},FittedBlock:{name:"FittedBlock",style:""},Instance:{name:"Instance",style:""},InstanceTree:{name:"InstanceTree",style:""},ChangeInterval:{name:"ChangeInterval",style:"color: #0a0;"},SVGBlock:{name:"SVG",style:""},SVGGroup:{name:"SVGGroup",style:""},ImageSVGDrawable:{name:"ImageSVGDrawable",style:""},Paints:{name:"Paints",style:""},Filters:{name:"Filters",style:""},AlignBox:{name:"AlignBox",style:""},AlignGroup:{name:"AlignGroup",style:""},RichText:{name:"RichText",style:""},Sim:{name:"Sim",style:""},ParallelDOM:{name:"ParallelDOM",style:""},PDOMInstance:{name:"PDOMInstance",style:""},PDOMTree:{name:"PDOMTree",style:""},PDOMDisplaysInfo:{name:"PDOMDisplaysInfo",style:""},KeyboardFuzzer:{name:"KeyboardFuzzer",style:""},InputListener:{name:"InputListener",style:""},InputEvent:{name:"InputEvent",style:""},OnInput:{name:"OnInput",style:""},Pointer:{name:"Pointer",style:""},Input:{name:"Input",style:""},EventDispatch:{name:"EventDispatch",style:""},EventPath:{name:"EventPath",style:""}};si(Ri,{logString:"",logFunction:function(...e){window.console&&window.console.log&&window.console.log(...Array.prototype.slice.call(e,0))},switchLogToConsole:function(){Ri.logFunction=Fi},switchLogToString:function(){window.console&&window.console.log("switching to string log"),Ri.logFunction=ki},enableIndividualLog:function(e){return"stitch"===e?(this.enableIndividualLog("Stitch"),this.enableIndividualLog("StitchDrawables"),this.enableIndividualLog("GreedyStitcher"),void this.enableIndividualLog("GreedyVerbose")):"perf"===e?(this.enableIndividualLog("PerfCritical"),this.enableIndividualLog("PerfMajor"),this.enableIndividualLog("PerfMinor"),void this.enableIndividualLog("PerfVerbose")):"input"===e?(this.enableIndividualLog("InputListener"),this.enableIndividualLog("InputEvent"),this.enableIndividualLog("OnInput"),this.enableIndividualLog("Pointer"),this.enableIndividualLog("Input"),this.enableIndividualLog("EventDispatch"),void this.enableIndividualLog("EventPath")):"a11y"===e||"pdom"===e?(this.enableIndividualLog("ParallelDOM"),this.enableIndividualLog("PDOMInstance"),this.enableIndividualLog("PDOMTree"),void this.enableIndividualLog("PDOMDisplaysInfo")):void(e&&(window.sceneryLog[e]=window.sceneryLog[e]||function(t,i){var r=ji[e],a=r.name?"[".concat(r.name,"] "):"";Ri.logFunction("%c".concat(Ci,"%c").concat(a).concat(t),"color: #ddd;",i||r.style)}))},disableIndividualLog:function(e){e&&delete window.sceneryLog[e]},enableLogging:function(e){window.sceneryLog=function(e){Ri.logFunction(e)},window.sceneryLog.push=function(){Ci+="| "},window.sceneryLog.pop=function(){Ci=Ci.slice(0,-2)},window.sceneryLog.getDepth=function(){return Ci.length/2};for(var t=0;t<e.length;t++)this.enableIndividualLog(e[t])},disableLogging:function(){window.sceneryLog=null},isLoggingPerformance:function(){return window.sceneryLog.PerfCritical||window.sceneryLog.PerfMajor||window.sceneryLog.PerfMinor||window.sceneryLog.PerfVerbose},copy:function(e){return Ri.deserialize(Ri.serialize(e))},serialize:function(e){if(e instanceof Lt.Vector2)return{type:"Vector2",x:e.x,y:e.y};if(e instanceof Lt.Matrix3)return{type:"Matrix3",m00:e.m00(),m01:e.m01(),m02:e.m02(),m10:e.m10(),m11:e.m11(),m12:e.m12(),m20:e.m20(),m21:e.m21(),m22:e.m22()};if(e instanceof Lt.Bounds2)return{type:"Bounds2",maxX:e.maxX,maxY:e.maxY,minX:e.minX,minY:e.minY};if(e instanceof Mi.Shape)return{type:"Shape",path:e.getSVGPath()};if(Array.isArray(e))return{type:"Array",value:e.map(Ri.serialize)};if(e instanceof Ri.Color)return{type:"Color",red:e.red,green:e.green,blue:e.blue,alpha:e.alpha};if(e instanceof h.Property)return{type:"Property",value:Ri.serialize(e.value)};if(Ri.Paint&&e instanceof Ri.Paint){var t={};return e.transformMatrix&&(t.transformMatrix=Ri.serialize(e.transformMatrix)),Ri.Gradient&&e instanceof Ri.Gradient&&(t.stops=e.stops.map(e=>({ratio:e.ratio,stop:Ri.serialize(e.color)})),t.start=Ri.serialize(e.start),t.end=Ri.serialize(e.end),Ri.LinearGradient&&e instanceof Ri.LinearGradient?t.type="LinearGradient":Ri.RadialGradient&&e instanceof Ri.RadialGradient&&(t.type="RadialGradient",t.startRadius=e.startRadius,t.endRadius=e.endRadius)),Ri.Pattern&&e instanceof Ri.Pattern&&(t.type="Pattern",t.url=e.image.src),t}if(e instanceof Ri.Node){var i=e,r={},a={};["visible","opacity","disabledOpacity","pickable","inputEnabled","cursor","transformBounds","renderer","usesOpacity","layerSplit","cssTransform","excludeInvisible","webglScale","preventFit"].forEach(e=>{i[e]!==Ri.Node.DEFAULT_OPTIONS[e]&&(r[e]=i[e])}),["maxWidth","maxHeight","clipArea","mouseArea","touchArea"].forEach(e=>{i[e]!==Ri.Node.DEFAULT_OPTIONS[e]&&(a[e]=Ri.serialize(i[e]))}),i.matrix.isIdentity()||(a.matrix=Ri.serialize(i.matrix)),i._localBoundsOverridden&&(a.localBounds=Ri.serialize(i.localBounds)),a.children=i.children.map(e=>e.id),a.hasInputListeners=i.inputListeners.length>0;var n={id:i.id,type:"Node",types:hi(i.constructor).map(e=>e.name).filter(e=>e&&"Object"!==e&&"Node"!==e),name:i.constructor.name,options:r,setup:a};if(Ri.Path&&i instanceof Ri.Path&&(n.type="Path",a.path=Ri.serialize(i.shape),i.boundsMethod!==Ri.Path.DEFAULT_OPTIONS.boundsMethod&&(r.boundsMethod=i.boundsMethod)),Ri.Circle&&i instanceof Ri.Circle&&(n.type="Circle",r.radius=i.radius),Ri.Line&&i instanceof Ri.Line&&(n.type="Line",r.x1=i.x1,r.y1=i.y1,r.x2=i.x2,r.y2=i.y2),Ri.Rectangle&&i instanceof Ri.Rectangle&&(n.type="Rectangle",r.rectX=i.rectX,r.rectY=i.rectY,r.rectWidth=i.rectWidth,r.rectHeight=i.rectHeight,r.cornerXRadius=i.cornerXRadius,r.cornerYRadius=i.cornerYRadius),Ri.Text&&i instanceof Ri.Text&&(n.type="Text","hybrid"!==i.boundsMethod&&(r.boundsMethod=i.boundsMethod),r.text=i.text,r.font=i.font),Ri.Image&&i instanceof Ri.Image&&(n.type="Image",["imageOpacity","initialWidth","initialHeight","mipmapBias","mipmapInitialLevel","mipmapMaxLevel"].forEach(e=>{i[e]!==Ri.Image.DEFAULT_OPTIONS[e]&&(r[e]=i[e])}),a.width=i.imageWidth,a.height=i.imageHeight,i._mipmapData?(a.imageType="mipmapData",a.mipmapData=i._mipmapData.map(e=>({url:e.url,width:e.width,height:e.height}))):(i._mipmap&&(a.generateMipmaps=!0),i._image instanceof HTMLImageElement?(a.imageType="image",a.src=i._image.src):i._image instanceof HTMLCanvasElement&&(a.imageType="canvas",a.src=i._image.toDataURL()))),Ri.CanvasNode&&i instanceof Ri.CanvasNode||Ri.WebGLNode&&i instanceof Ri.WebGLNode){n.type=Ri.CanvasNode&&i instanceof Ri.CanvasNode?"CanvasNode":"WebGLNode",a.canvasBounds=Ri.serialize(i.canvasBounds);Math.min(5,i._drawables.length?1/_.mean(i._drawables.map(e=>{var t=e.instance.trail.getMatrix().getScaleVector();return(t.x+t.y)/2})):1);1;var s=document.createElement("canvas");s.width=Math.ceil(1*i.canvasBounds.width),s.height=Math.ceil(1*i.canvasBounds.height);var o=s.getContext("2d"),l=new Ri.CanvasContextWrapper(s,o),p=Lt.Matrix3.scale(1);l.context.setTransform(1,0,0,1,-i.canvasBounds.left,-i.canvasBounds.top),i.renderToCanvasSelf(l,p),a.url=s.toDataURL(),a.scale=1,a.offset=Ri.serialize(i.canvasBounds.leftTop)}return Ri.DOM&&i instanceof Ri.DOM&&(n.type="DOM",n.element=(new window.XMLSerializer).serializeToString(i.element),i.element instanceof window.HTMLCanvasElement&&(n.dataURL=i.element.toDataURL()),r.preventTransform=i.preventTransform),(Ri.Path&&i instanceof Ri.Path||Ri.Text&&i instanceof Ri.Text)&&(["fillPickable","strokePickable","lineWidth","lineCap","lineJoin","lineDashOffset","miterLimit"].forEach(e=>{i[e]!==Ri.Paintable.DEFAULT_OPTIONS[e]&&(r[e]=i[e])}),i.fill!==Ri.Paintable.DEFAULT_OPTIONS.fill&&(a.fill=Ri.serialize(i.fill)),i.stroke!==Ri.Paintable.DEFAULT_OPTIONS.stroke&&(a.stroke=Ri.serialize(i.stroke)),i.lineDash.length&&(a.lineDash=Ri.serialize(i.lineDash))),n}return e instanceof Ri.Display?{type:"Display",width:e.width,height:e.height,backgroundColor:Ri.serialize(e.backgroundColor),tree:{type:"Subtree",rootNodeId:e.rootNode.id,nodes:Ri.serializeConnectedNodes(e.rootNode)}}:{type:"value",value:e}},deserialize:function(e){if("Vector2"===e.type)return new Lt.Vector2(e.x,e.y);if("Matrix3"===e.type)return(new Lt.Matrix3).rowMajor(e.m00,e.m01,e.m02,e.m10,e.m11,e.m12,e.m20,e.m21,e.m22);if("Bounds2"===e.type)return new Lt.Bounds2(e.minX,e.minY,e.maxX,e.maxY);if("Shape"===e.type)return new Mi.Shape(e.path);if("Array"===e.type)return e.value.map(Ri.deserialize);if("Color"===e.type)return new Ri.Color(e.red,e.green,e.blue,e.alpha);if("Property"===e.type)return new h.Property(Ri.deserialize(e.value));if("Pattern"===e.type||"LinearGradient"===e.type||"RadialGradient"===e.type){var t;if("Pattern"===e.type){var i=new window.Image;i.src=e.url,t=new Ri.Pattern(i)}else{var r=Ri.deserialize(e.start),a=Ri.deserialize(e.end);"LinearGradient"===e.type?t=new Ri.LinearGradient(r.x,r.y,a.x,a.y):"RadialGradient"===e.type&&(t=new Ri.RadialGradient(r.x,r.y,e.startRadius,a.x,a.y,e.endRadius)),e.stops.forEach(e=>{t.addColorStop(e.ratio,Ri.deserialize(e.stop))})}return e.transformMatrix&&t.setTransformMatrix(Ri.deserialize(e.transformMatrix)),t}if(_.includes(["Node","Path","Circle","Line","Rectangle","Text","Image","CanvasNode","WebGLNode","DOM"],e.type)){var n,s=e.setup;if("Node"===e.type)n=new Ri.Node;else if("Path"===e.type)n=new Ri.Path(Ri.deserialize(s.path));else if("Circle"===e.type)n=new Ri.Circle({});else if("Line"===e.type)n=new Ri.Line({});else if("Rectangle"===e.type)n=new Ri.Rectangle({});else if("Text"===e.type)n=new Ri.Text("");else if("Image"===e.type){if("image"===s.imageType||"canvas"===s.imageType)n=new Ri.Image(s.src),s.generateMipmaps&&(n.mipmaps=!0);else if("mipmapData"===s.imageType){var o=s.mipmapData.map(e=>{var t={width:e.width,height:e.height,url:e.url};t.img=new window.Image,t.img.src=e.url,t.canvas=document.createElement("canvas"),t.canvas.width=e.width,t.canvas.height=e.height;var i=t.canvas.getContext("2d");return t.updateCanvas=function(){t.img.complete&&(void 0===t.img.naturalWidth||t.img.naturalWidth>0)&&(i.drawImage(t.img,0,0),delete t.updateCanvas)},t});n=new Ri.Image(o)}n.initialWidth=s.width,n.initialHeight=s.height}else if("CanvasNode"===e.type||"WebGLNode"===e.type)n=new Ri.Node({children:[new Ri.Image(s.url,{translation:Ri.deserialize(s.offset),scale:1/s.scale})]});else if("DOM"===e.type){var l=document.createElement("div");l.innerHTML=e.element;var p=l.childNodes[0];if(l.removeChild(p),e.dataURL){var u=new window.Image;u.onload=()=>{p.getContext("2d").drawImage(u,0,0)},u.src=e.dataURL}n=new Ri.DOM(p)}return s.clipArea&&(n.clipArea=Ri.deserialize(s.clipArea)),s.mouseArea&&(n.mouseArea=Ri.deserialize(s.mouseArea)),s.touchArea&&(n.touchArea=Ri.deserialize(s.touchArea)),s.matrix&&(n.matrix=Ri.deserialize(s.matrix)),s.localBounds&&(n.localBounds=Ri.deserialize(s.localBounds)),s.fill&&(n.fill=Ri.deserialize(s.fill)),s.stroke&&(n.stroke=Ri.deserialize(s.stroke)),s.lineDash&&(n.lineDash=Ri.deserialize(s.lineDash)),n.mutate(e.options),n._serialization=e,n}if("Subtree"===e.type){var d={},c=e.nodes.map(Ri.deserialize);return c.forEach(e=>{d[e._serialization.id]=e}),c.forEach(e=>{e._serialization.setup.children.forEach(t=>{e.addChild(d[t])})}),d[e.rootNodeId]}return"value"===e.type?e.value:null},serializeConnectedNodes:function(e){return e.getSubtreeNodes().map(Ri.serialize)}});var Ui=Ri,Bi={nameObjectContextHint:"{{NAME}}, {{OBJECT}}, {{CONTEXT}} {{HINT}}",nameObjectContext:"{{NAME}}, {{OBJECT}}, {{CONTEXT}}",nameObjectHint:"{{NAME}}, {{OBJECT}}, {{HINT}}",nameContextHint:"{{NAME}}, {{CONTEXT}} {{HINT}}",nameObject:"{{NAME}}, {{OBJECT}}, ",nameContext:"{{NAME}}, {{CONTEXT}}",nameHint:"{{NAME}}, {{HINT}}",name:"{{NAME}}",objectContextHint:"{{OBJECT}}, {{CONTEXT}} {{HINT}}",objectContext:"{{OBJECT}}, {{CONTEXT}}",objectHint:"{{OBJECT}}, {{HINT}}",contextHint:"{{CONTEXT}} {{HINT}}",object:"{{OBJECT}} ",context:"{{CONTEXT}}",hint:"{{HINT}}"};class zi{constructor(e){e=l({},Bi,e),this.nameObjectContextHint=e.nameObjectContextHint,this.nameObjectContext=e.nameObjectContext,this.nameObjectHint=e.nameObjectHint,this.nameContextHint=e.nameContextHint,this.nameObject=e.nameObject,this.nameContext=e.nameContext,this.nameHint=e.nameHint,this.name=e.name,this.objectContextHint=e.objectContextHint,this.objectContext=e.objectContext,this.objectHint=e.objectHint,this.contextHint=e.contextHint,this.object=e.object,this.context=e.context,this.hint=e.hint}static createPatternKey(e,t,i,r){var a="";return e&&(a=a.concat("NAME".concat("_"))),t&&(a=a.concat("OBJECT".concat("_"))),i&&(a=a.concat("CONTEXT".concat("_"))),r&&(a=a.concat("HINT".concat("_"))),_.camelCase(a)}}zi.DEFAULT_RESPONSE_PATTERNS=new zi,Ui.register("ResponsePatterns",zi);var Hi=zi,qi=new t("utteranceQueue"),Gi={nameResponse:null,objectResponse:null,contextResponse:null,hintResponse:null,ignoreProperties:!1,responsePatterns:Hi.DEFAULT_RESPONSE_PATTERNS};class Yi{constructor(e){e=l({},Gi,e),this.nameResponse=e.nameResponse,this.objectResponse=e.objectResponse,this.contextResponse=e.contextResponse,this.hintResponse=e.hintResponse,this.ignoreProperties=e.ignoreProperties,this.responsePatterns=e.responsePatterns}}Yi.DEFAULT_OPTIONS=Gi,qi.register("ResponsePacket",Yi);var Wi=Yi,Xi={isAlertableDef:function(e){var t=!0;if(Array.isArray(e))for(var i=0;i<e.length&&(t=Ki(e[i]));i++);else t=Ki(e);return t}},Ki=function(e){return"string"==typeof e||"number"==typeof e||e instanceof Wi||e instanceof ar};qi.register("AlertableDef",Xi);var Ji=new t("phetcommon"),Qi={format:function(e){var t=arguments;return e.replace(/{(\d)}/g,(e,i)=>t[+i+1])},fillIn:function(e,t){for(var i=e,r=e.match(/\{\{[^{}]+\}\}/g)||[],a=0;a<r.length;a++){var n=r[a],s=n.replace("{{","").replace("}}","");void 0!==t[s]&&(i=i.replace(n,t[s]))}return i},isEmbeddingMark:function(e){return"‪"===e||"‫"===e||"‬"===e},embeddedSlice:function(e,t,i){var r,a=[];for(void 0===i&&(i=e.length),i<0&&(i+=e.length);t<e.length&&Qi.isEmbeddingMark(e.charAt(t));)t++;for(;i>=1&&Qi.isEmbeddingMark(e.charAt(i-1));)i--;if(t>=i||t>=e.length)return"";for(var n=0;n<t;n++)"‪"===(r=e.charAt(n))||"‫"===r?a.push(r):"‬"===r&&a.pop();for(var s=a.length,o=a.slice(),l=e.slice(t,i),h=0;h<l.length;h++)"‪"===(r=l.charAt(h))||"‫"===r?a.push(r):"‬"===r&&(a.pop(),s=Math.min(a.length,s));var p=a,u=Math.max(0,s-1);return o=o.slice(u),p=p.slice(u),o.join("")+l+p.join("").replace(/./g,"‬")},embeddedSplit:function(e,t,i){if(void 0===t)return[e];var r,a=[],n=e;function s(){var e,i;if(t instanceof window.RegExp){var r=n.match(t);r?(e=r.index,i=r[0].length):e=-1}else e=n.indexOf(t),i=t.length;return{index:e,length:i}}for(var o=0;(r=s()).index>=0;){a.push(Qi.embeddedSlice(e,o,o+r.index));var l=r.index+r.length;n=n.slice(l),o+=l}return a.push(Qi.embeddedSlice(e,o)),void 0!==i&&(a=_.first(a,i)),a},embeddedDebugString:function(e){return e.replace(/\u202a/g,"[LTR]").replace(/\u202b/g,"[RTL]").replace(/\u202c/g,"[POP]")},assertContainsKey(e,t){},capitalize:e=>e[0].toUpperCase()+e.slice(1)};Ji.register("StringUtils",Qi);var Zi=Qi;var $i=new class{constructor(){this.nameResponsesEnabledProperty=new dt(!0),this.objectResponsesEnabledProperty=new dt(!1),this.contextResponsesEnabledProperty=new dt(!1),this.hintResponsesEnabledProperty=new dt(!1)}reset(){this.nameResponsesEnabledProperty.reset(),this.objectResponsesEnabledProperty.reset(),this.contextResponsesEnabledProperty.reset(),this.hintResponsesEnabledProperty.reset()}collectResponses(e){var t=(e=l({},Wi.DEFAULT_OPTIONS,e)).nameResponse&&(this.nameResponsesEnabledProperty.get()||e.ignoreProperties),i=e.objectResponse&&(this.objectResponsesEnabledProperty.get()||e.ignoreProperties),r=e.contextResponse&&(this.contextResponsesEnabledProperty.get()||e.ignoreProperties),a=e.hintResponse&&(this.hintResponsesEnabledProperty.get()||e.ignoreProperties),n=Hi.createPatternKey(t,i,r,a),s="";if(n){var o=e.responsePatterns[n];s=Zi.fillIn(o,{NAME:e.nameResponse,OBJECT:e.objectResponse,CONTEXT:e.contextResponse,HINT:e.hintResponse})}return s}};Ui.register("responseCollector",$i);var er=$i,tr={isValidValue:e=>"string"==typeof e||Array.isArray(e)&&_.every(e,e=>"string"==typeof e)},ir=1;class rr{constructor(e){e=l({alert:null,loopAlerts:!1,predicate:function(){return!0},alertStableDelay:200,alertMaximumDelay:Number.MAX_VALUE,announcerOptions:{}},e),this.id=ir++,this._alert=e.alert,this.loopAlerts=e.loopAlerts,this.numberOfTimesAlerted=0,this.predicate=e.predicate,this.alertStableDelay=e.alertStableDelay,this.alertMaximumDelay=e.alertMaximumDelay,this.announcerOptions=e.announcerOptions}getAlertStringFromResponsePacket(e,t){var i=_.extend({},e);return t||(i.ignoreProperties=!0),er.collectResponses(i)}getAlertText(e=!1){var t;if("string"==typeof this._alert||this._alert instanceof Wi)t=this._alert;else if(this.loopAlerts)t=this._alert[this.numberOfTimesAlerted%this._alert.length];else{var i=Math.min(this.numberOfTimesAlerted,this._alert.length-1);t=this._alert[i]}return t instanceof Wi&&(t=this.getAlertStringFromResponsePacket(t,e)),t}getTextToAlert(e){var t=this.getAlertText(e);return this.numberOfTimesAlerted++,t}set alert(e){A(e,tr),this.numberOfTimesAlerted=0,this._alert=e}get alert(){return this._alert}setAlertStableDelay(e){this.alertStableDelay=e}toString(){return"Utterance_".concat(this.id,"#").concat(this.getAlertText())}reset(){this.numberOfTimesAlerted=0}}qi.register("Utterance",rr);var ar=rr;class nr extends ar{constructor(e){super(e=l({alertStableDelay:500},e))}}qi.register("ActivationUtterance",nr);function sr(e){return e.replace(/\u202a|\u202b|\u202c/g,"")}a.register("stripEmbeddingMarks",sr);var or=sr,lr=document.createElement("style");lr.type="text/css",document.head.appendChild(lr);var hr=document.styleSheets[document.styleSheets.length-1],pr={stylesheet:hr,styleElement:lr,addRule(e){this.stylesheet.insertRule(e,0)}};Ui.register("SceneryStyle",pr);var ur=pr;ur.addRule(".".concat("a11y-pdom-element","{")+"position: fixed;pointer-events: none;top: 0px;left: 0px;transform-origin: left top 0px;border-width: 0px;border: 0px;padding: 1px 1px;margin: 0px;white-space: nowrap;outline: none;box-shadow:none;border-color:transparent;font-size: 1px;clip: rect(1px, 1px, 1px, 1px);}"),ur.addRule(".".concat("a11y-pdom-root","{")+"position: absolute;z-index: 1;opacity: 0.0001;}"),ur.addRule(".".concat("a11y-pdom-list-item","{")+"list-style: none;");var dr={SIBLING_CLASS_NAME:"a11y-pdom-element",ROOT_CLASS_NAME:"a11y-pdom-root",LIST_ITEM_CLASS_NAME:"a11y-pdom-list-item"};Ui.register("PDOMSiblingStyle",dr);var cr=dr,mr=["A","AREA","INPUT","SELECT","TEXTAREA","BUTTON","IFRAME"],yr=["B","STRONG","I","EM","MARK","SMALL","DEL","INS","SUB","SUP","BR"],gr=["INPUT"];function vr(e){for(var t=e.getElementsByTagName("*"),i=[],r=0;r<t.length;r++)t[r].nodeType===Node.ELEMENT_NODE&&(i[r]=t[r]);return i}function fr(e,t){for(var i=vr(t||document.body),r=document.activeElement,a="NEXT"===e?1:-1,n=i.indexOf(r)+a;n<i.length&&n>=0;){var s=i[n];if(n+=a,Er.isElementFocusable(s))return s}return r}function Tr(e){return!_.includes(gr,e.toUpperCase())}var Er={getNextFocusable:e=>fr("NEXT",e),getPreviousFocusable:e=>fr("PREVIOUS",e),getFirstFocusable(e){for(var t=vr(e||document.body),i=document.body,r=0;r<t.length;){var a=t[r];if(r++,Er.isElementFocusable(a)){i=a;break}}return i},getRandomFocusable(e){for(var t=vr(document.body),i=[],r=0;r<t.length;r++)Er.isElementFocusable(t[r])&&i.push(t[r]);return i[e.nextInt(i.length)]},containsFormattingTags(e){if(null===e)return!1;for(var t=0,i=[],r=[];t<e.length;){var a=e.indexOf("<",t),n=e.indexOf(">",t);a>-1&&(i.push(a),t=a+1),n>-1?(r.push(n),t=n+1):t++}if(i.length!==r.length||0===i.length)return!1;for(var s=!0,o=e.toUpperCase(),l=0;l<i.length;l++){var h=o.substring(i[l]+1,r[l]);h=h.replace("/","");var p=h.replace(/^\s+/,"");h.length-p.length>0||(_.includes(yr,h)||(s=!1))}return s},setTextContent(e,t){if(null===t)e.innerHTML="";else{var i=or(t);A(i,b.STRING_WITHOUT_TEMPLATE_VARS_VALIDATOR),Tr(e.tagName)&&(Er.containsFormattingTags(i)?e.innerHTML=i:e.textContent=i)}},tagIsDefaultFocusable:e=>_.includes(mr,e.toUpperCase()),isElementFocusable:e=>!!document.body.contains(e)&&(!function e(t){return!!t.hidden||t!==document.body&&e(t.parentElement)}(e)&&(!_.includes(yr,e.tagName)&&"true"===e.getAttribute("data-focusable"))),tagNameSupportsContent:e=>Tr(e),removeElements(e,t){for(var i=0;i<t.length;i++){var r=t[i];e.removeChild(r)}},insertElements(e,t,i){for(var r=0;r<t.length;r++){var a=t[r];e.insertBefore(a,i||null)}},validateAssociationObject(e){Object.keys(e)},createElement(e,t,i){var r=(i=l({namespace:null,id:null,trailId:null},i)).namespace?document.createElementNS(i.namespace,e):document.createElement(e);return i.trailId&&r.setAttribute(Er.DATA_TRAIL_ID,i.trailId),i.id&&(r.id=i.id),Er.overrideFocusWithTabIndex(r,t),r.classList.add(cr.SIBLING_CLASS_NAME),r},overrideFocusWithTabIndex(e,t){Er.tagIsDefaultFocusable(e.tagName)!==t?e.tabIndex=t?0:-1:e.removeAttribute("tabindex"),e.setAttribute("data-focusable",t)},TAGS:{INPUT:"INPUT",LABEL:"LABEL",BUTTON:"BUTTON",TEXTAREA:"TEXTAREA",SELECT:"SELECT",OPTGROUP:"OPTGROUP",DATALIST:"DATALIST",OUTPUT:"OUTPUT",DIV:"DIV",A:"A",P:"P",B:"B",STRONG:"STRONG",I:"I",EM:"EM",MARK:"MARK",SMALL:"SMALL",DEL:"DEL",INS:"INS",SUB:"SUB",SUP:"SUP"},FORM_ELEMENTS:["INPUT","BUTTON","TEXTAREA","SELECT","OPTGROUP","DATALIST","OUTPUT","A"],DEFAULT_CONTAINER_TAG_NAME:"DIV",DEFAULT_DESCRIPTION_TAG_NAME:"P",DEFAULT_LABEL_TAG_NAME:"P",ASSOCIATION_ATTRIBUTES:["aria-labelledby","aria-describedby","aria-activedescendant"],INPUT_TYPES_THAT_SUPPORT_CHECKED:["RADIO","CHECKBOX"],DOM_EVENTS:["focusin","focusout","input","change","click","keydown","keyup"],BLOCKED_DOM_EVENTS:["touchstart","touchend","touchmove","touchcancel","mousedown","mouseup","mousemove","mouseover","mouseout","pointerdown","pointerup","pointermove","pointerover","pointerout","pointercancel","gotpointercapture","lostpointercapture"],DATA_TRAIL_ID:"data-trail-id",DATA_EXCLUDE_FROM_INPUT:"data-exclude-from-input"};Ui.register("PDOMUtils",Er);var Pr=Er;class br{constructor(e){e=l({respectResponseCollectorProperties:!0},e),this.respectResponseCollectorProperties=e.respectResponseCollectorProperties}announce(e,t){throw new Error("announce() must be overridden by subtype")}}qi.register("Announcer",br);var Or=br,Ar=1,Ir=g.byKeys(["POLITE","ASSERTIVE"]);function wr(e){for(var t=document.createElement("div"),i=1;i<=4;i++){var r=document.createElement("p");r.setAttribute("id","elements-".concat(Ar,"-").concat(e,"-").concat(i)),r.setAttribute("aria-live",e),t.appendChild(r)}return t}class Sr extends Or{constructor(e){super(e=l({respectResponseCollectorProperties:!1},e)),this.politeElementIndex=0,this.assertiveElementIndex=0,this.announcingEmitter=new wt({parameters:[{valueType:"string"},{valueType:Sr.AriaLive}]}),this.ariaLiveContainer=document.createElement("div"),this.ariaLiveContainer.setAttribute("id","aria-live-elements-".concat(Ar)),this.ariaLiveContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; width: 0px; height: 0px; clip: rect(0px 0px 0px 0px); pointer-events: none;"),this.politeElements=wr("polite"),this.assertiveElements=wr("assertive"),this.ariaLiveContainer.appendChild(this.politeElements),this.ariaLiveContainer.appendChild(this.assertiveElements),this.politeElements=Array.from(this.politeElements.children),this.assertiveElements=Array.from(this.assertiveElements.children),this.announcingEmitter.addListener((e,t)=>{if(t===Ir.POLITE){var i=this.politeElements[this.politeElementIndex];this.updateLiveElement(i,e),this.politeElementIndex=(this.politeElementIndex+1)%this.politeElements.length}else if(t===Ir.ASSERTIVE){var r=this.assertiveElements[this.assertiveElementIndex];this.updateLiveElement(r,e),this.assertiveElementIndex=(this.assertiveElementIndex+1)%this.assertiveElements.length}}),Ar++}announce(e,t){t=l({ariaLivePriority:Ir.POLITE},t),this.announcingEmitter.emit(e.getTextToAlert(this.respectResponseCollectorProperties),t.ariaLivePriority)}updateLiveElement(e,t){e.textContent="",e.hidden=!1,mt.setTimeout(()=>{Pr.setTextContent(e,t),mt.setTimeout(()=>{_i.safari?e.hidden=!0:e.textContent=""},200)},0)}}Sr.AriaLive=Ir,qi.register("AriaHerald",Sr);var Dr=Sr;class _r extends Ie{constructor(e,t){(t=l({implementAsSkeleton:!1,tandem:oe.OPTIONAL,phetioType:_r.UtteranceQueueIO,phetioState:!1},t)).implementAsSkeleton&&(t.tandem=oe.OPT_OUT),super(t),this.announcer=e,this._initialized=!t.implementAsSkeleton,this.queue=[],this._muted=!1,this._enabled=!0,this._initialized&&(this.stepQueueListener=this.stepQueue.bind(this),mt.addListener(this.stepQueueListener))}get length(){return this.queue.length}addToBack(e){if(this.initializedAndEnabled){var t=this.prepareUtterance(e);this.queue.push(t)}}addToFront(e){if(this.initializedAndEnabled){var t=this.prepareUtterance(e);this.queue.unshift(t)}}prepareUtterance(e){e instanceof ar||(e=new ar({alert:e}));var t=new Nr(e);return this.removeOthersAndUpdateUtteranceWrapper(t),t.stableTime=0,t}removeUtterance(e,t){t=l({assertExists:!0},t),_.remove(this.queue,t=>t.utterance===e)}removeOthersAndUpdateUtteranceWrapper(e,t){for(var i=[],r=0;r<this.queue.length;r++){this.queue[r].utterance===e.utterance&&i.push(e.timeInQueue)}e.timeInQueue=Math.max(i),_.remove(this.queue,t=>t.utterance===e.utterance)}get initializedAndEnabled(){return this._enabled&&this._initialized}getNextUtterance(){for(var e=null,t=0;t<this.queue.length;t++){var i=this.queue[t];if(i.stableTime>i.utterance.alertStableDelay||i.timeInQueue>i.utterance.alertMaximumDelay){e=i.utterance,this.queue.splice(t,1);break}}return e}hasUtterance(e){for(var t=0;t<this.queue.length;t++){if(e===this.queue[t].utterance)return!0}return!1}clear(){this.queue=[]}setMuted(e){this._muted=e}set muted(e){this.setMuted(e)}getMuted(){return this._muted}get muted(){return this.getMuted()}setEnabled(e){this._enabled=e}set enabled(e){this.setEnabled(e)}isEnabled(){return this._enabled}get enabled(){return this.isEnabled()}stepQueue(e){if(this._enabled&&0!==this.queue.length){e*=1e3;for(var t=0;t<this.queue.length;t++)this.queue[t].timeInQueue+=e,this.queue[t].stableTime+=e;var i=this.getNextUtterance();i&&this.attemptToAnnounce(i)}}announceImmediately(e){this.initializedAndEnabled&&(e instanceof ar||(e=new ar({alert:e})),this.attemptToAnnounce(e))}attemptToAnnounce(e){!this._muted&&e.predicate()&&this.announcer.announce(e,e.announcerOptions)}dispose(){this._initialized&&mt.removeListener(this.stepQueueListener),super.dispose()}static fromFactory(){var e=new Dr,t=new _r(e),i=e.ariaLiveContainer;document.body?document.body.appendChild(i):document.children[0].appendChild(i);var r=Date.now(),a=e=>{var t=e-r;r=e,console.log(t/1e3),phet.axon.stepTimer.emit(t/1e3),window.requestAnimationFrame(a)};return window.requestAnimationFrame(a),t}}class Nr{constructor(e){this.utterance=e,this.timeInQueue=0,this.stableTime=0}resetTimingVariables(){this.timeInQueue=0,this.stableTime=0}}_r.UtteranceQueueIO=new B("UtteranceQueueIO",{valueType:_r,documentation:"Manages a queue of Utterances that are read in order by a screen reader.",events:["announced"],methods:{addToBack:{returnType:Se,parameterTypes:[ue],implementation:function(e){return this.addToBack(e)},documentation:"Add the utterance (string) to the end of the queue.",invocableForReadOnlyElements:!1},addToFront:{returnType:Se,parameterTypes:[ue],implementation:function(e){return this.addToFront(e)},documentation:"Add the utterance (string) to the beginning of the queue.",invocableForReadOnlyElements:!1},setMuted:{returnType:Se,parameterTypes:[Re],implementation:function(e){this.muted(e)},documentation:"Set whether the utteranceQueue will be muted or not. If muted, utterances still move through the queue but will not be read by screen readers.",invocableForReadOnlyElements:!1},getMuted:{returnType:Re,parameterTypes:[Se],implementation:function(){return this.muted()},documentation:"Get whether the utteranceQueue is muted. If muted, utterances still move through the queue but will not be read by screen readers."},setEnabled:{returnType:Se,parameterTypes:[Re],implementation:function(e){this.enabled(e)},documentation:"Set whether the utteranceQueue will be enabled or not. When enabled, Utterances cannot be added to the queue, and the Queue cannot be cleared. Also nothing will be sent to assistive technology.",invocableForReadOnlyElements:!1},isEnabled:{returnType:Re,parameterTypes:[Se],implementation:function(){return this.enabled()},documentation:"Get whether the utteranceQueue is enabled. When enabled, Utterances cannot be added to the queue, and the Queue cannot be cleared. Also nothing will be sent to assistive technology."}}}),qi.register("UtteranceQueue",_r);var Lr={},Mr=e=>{window.phet&&window.phet.chipper&&window.phet.chipper.queryParameters&&phet.chipper.queryParameters.deprecationWarnings&&(Lr.hasOwnProperty(e)||(Lr[e]=!0,console.warn("Deprecation warning: ".concat(e))))};a.register("deprecationWarning",Mr);var xr=Mr;class Vr extends ar{constructor(e){xr("Please use AccessibleValueHander.a11yCreateContextResponseAlert(), see https://github.com/phetsims/sun/issues/685"),super(e=l({alertStableDelay:1e3},e))}}qi.register("ValueChangeUtterance",Vr)})()})()}();